import os
import sys
import copy
from math import gcd
from driver_config_macros import *
from data_capture_macros import *
from signal_generator_macros import *
from power_operation_macros import *
from capture_config_macros import *
from trig_config_macros import *
from data_processing_macros import *
from PyQt5 import QtCore, QtGui, QtWidgets
import matplotlib
matplotlib.use('Qt5Agg')
from matplotlib import pyplot as plt
from matplotlib.backends.backend_qt5agg import FigureCanvasQTAgg
from matplotlib.figure import Figure

app_ = QtWidgets.QApplication(sys.argv)
w, h = app_.primaryScreen().size().width(), app_.primaryScreen().size().height()
#Screen Ratio Corrections
gcd_ = gcd(w, h)
resRatio = w/h
baseRatio = 16/9
wR = w/(gcd_*16) #Ratio Correction
hR = h/(gcd_*9) #Ratio Correction
widthRatio = 1#1/wR #Full Width Ratio Correction
heightRatio = 1#1/hR #Full Height Ratio Correction
app_.exit()

conditionList = {'conditionTab': [], 'extConditionLabel': [], 'aConditionLabel': [], 'bConditionLabel': [], 'cConditionLabel': [], 'dConditionLabel': [],
                 'aStateComboBox': [], 'bStateComboBox': [], 'cStateComboBox': [], 'dStateComboBox': [], 'extStateComboBox': [], 'stateLabel': []}
runList = {'runTab': [], 'stackedWidget': [], 'captureTab': []}

class Canvas(FigureCanvasQTAgg):
    def __init__(self, parent=None, width=4.61*widthRatio, height=3.61*heightRatio, dpi=100):
        fig, self.axes = plt.subplots(figsize=(width, height), dpi=dpi)
        super().__init__(fig)

class Ui_MainWindow(object):
    def setupUi(self, MainWindow):
        MainWindow.setObjectName("MainWindow")
        MainWindow.resize(801*widthRatio, 580*heightRatio)
        MainWindow.setMinimumSize(QtCore.QSize(801*widthRatio, 580*heightRatio))
        MainWindow.setMaximumSize(QtCore.QSize(801*widthRatio, 580*heightRatio))
        icon = QtGui.QIcon()
        icon.addPixmap(QtGui.QPixmap(".\\icon.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        MainWindow.setWindowIcon(icon)
        self.centralwidget = QtWidgets.QWidget(MainWindow)
        self.centralwidget.setEnabled(True)
        self.centralwidget.setObjectName("centralwidget")
        self.driverLabel = QtWidgets.QLabel(self.centralwidget)
        self.driverLabel.setGeometry(QtCore.QRect(20*widthRatio, 10*heightRatio, 51*widthRatio, 21*heightRatio))
        self.driverLabel.setObjectName("driverLabel")
        self.presetComboBox = QtWidgets.QComboBox(self.centralwidget)
        self.presetComboBox.setGeometry(QtCore.QRect(60*widthRatio, 40*heightRatio, 91*widthRatio, 22*heightRatio))
        self.presetComboBox.setEditable(False)
        self.presetComboBox.setObjectName("presetComboBox")
        self.presetComboBox.addItem("")
        self.presetLabel = QtWidgets.QLabel(self.centralwidget)
        self.presetLabel.setGeometry(QtCore.QRect(20*widthRatio, 40*heightRatio, 41*widthRatio, 21*heightRatio))
        self.presetLabel.setObjectName("presetLabel")
        self.channelBox = QtWidgets.QGroupBox(self.centralwidget)
        self.channelBox.setGeometry(QtCore.QRect(210*widthRatio, 0*heightRatio, 281*widthRatio, 121*heightRatio))
        self.channelBox.setObjectName("channelBox")
        self.aLabel = QtWidgets.QLabel(self.channelBox)
        self.aLabel.setGeometry(QtCore.QRect(10*widthRatio, 30*heightRatio, 21*widthRatio, 16*heightRatio))
        self.aLabel.setObjectName("aLabel")
        self.bLabel = QtWidgets.QLabel(self.channelBox)
        self.bLabel.setGeometry(QtCore.QRect(10*widthRatio, 50*heightRatio, 21*widthRatio, 16*heightRatio))
        self.bLabel.setObjectName("bLabel")
        self.cLabel = QtWidgets.QLabel(self.channelBox)
        self.cLabel.setGeometry(QtCore.QRect(10*widthRatio, 70*heightRatio, 21*widthRatio, 16*heightRatio))
        self.cLabel.setObjectName("cLabel")
        self.dLabel = QtWidgets.QLabel(self.channelBox)
        self.dLabel.setGeometry(QtCore.QRect(10*widthRatio, 90*heightRatio, 21*widthRatio, 16*heightRatio))
        self.dLabel.setObjectName("dLabel")
        self.aCheck = QtWidgets.QCheckBox(self.channelBox)
        self.aCheck.setGeometry(QtCore.QRect(30*widthRatio, 30*heightRatio, 16*widthRatio, 17*heightRatio))
        self.aCheck.setText("")
        self.aCheck.setObjectName("aCheck")
        self.bCheck = QtWidgets.QCheckBox(self.channelBox)
        self.bCheck.setGeometry(QtCore.QRect(30*widthRatio, 50*heightRatio, 16*widthRatio, 17*heightRatio))
        self.bCheck.setText("")
        self.bCheck.setObjectName("bCheck")
        self.cCheck = QtWidgets.QCheckBox(self.channelBox)
        self.cCheck.setGeometry(QtCore.QRect(30*widthRatio, 70*heightRatio, 16*widthRatio, 17*heightRatio))
        self.cCheck.setText("")
        self.cCheck.setObjectName("cCheck")
        self.dCheck = QtWidgets.QCheckBox(self.channelBox)
        self.dCheck.setGeometry(QtCore.QRect(30*widthRatio, 90*heightRatio, 16*widthRatio, 17*heightRatio))
        self.dCheck.setText("")
        self.dCheck.setObjectName("dCheck")
        self.aRangeComboBox = QtWidgets.QComboBox(self.channelBox)
        self.aRangeComboBox.setGeometry(QtCore.QRect(60*widthRatio, 30*heightRatio, 69*widthRatio, 16*heightRatio))
        self.aRangeComboBox.setObjectName("aRangeComboBox")
        self.aRangeComboBox.addItem("")
        self.aRangeComboBox.addItem("")
        self.aRangeComboBox.addItem("")
        self.aRangeComboBox.addItem("")
        self.aRangeComboBox.addItem("")
        self.aRangeComboBox.addItem("")
        self.aRangeComboBox.addItem("")
        self.aRangeComboBox.addItem("")
        self.aRangeComboBox.addItem("")
        self.aRangeComboBox.addItem("")
        self.aRangeComboBox.addItem("")
        self.aRangeComboBox.addItem("")
        self.bRangeComboBox = QtWidgets.QComboBox(self.channelBox)
        self.bRangeComboBox.setGeometry(QtCore.QRect(60*widthRatio, 50*heightRatio, 69*widthRatio, 16*heightRatio))
        self.bRangeComboBox.setObjectName("bRangeComboBox")
        self.bRangeComboBox.addItem("")
        self.bRangeComboBox.addItem("")
        self.bRangeComboBox.addItem("")
        self.bRangeComboBox.addItem("")
        self.bRangeComboBox.addItem("")
        self.bRangeComboBox.addItem("")
        self.bRangeComboBox.addItem("")
        self.bRangeComboBox.addItem("")
        self.bRangeComboBox.addItem("")
        self.bRangeComboBox.addItem("")
        self.bRangeComboBox.addItem("")
        self.bRangeComboBox.addItem("")
        self.cRangeComboBox = QtWidgets.QComboBox(self.channelBox)
        self.cRangeComboBox.setGeometry(QtCore.QRect(60*widthRatio, 70*heightRatio, 69*widthRatio, 16*heightRatio))
        self.cRangeComboBox.setObjectName("cRangeComboBox")
        self.cRangeComboBox.addItem("")
        self.cRangeComboBox.addItem("")
        self.cRangeComboBox.addItem("")
        self.cRangeComboBox.addItem("")
        self.cRangeComboBox.addItem("")
        self.cRangeComboBox.addItem("")
        self.cRangeComboBox.addItem("")
        self.cRangeComboBox.addItem("")
        self.cRangeComboBox.addItem("")
        self.cRangeComboBox.addItem("")
        self.cRangeComboBox.addItem("")
        self.cRangeComboBox.addItem("")
        self.dRangeComboBox = QtWidgets.QComboBox(self.channelBox)
        self.dRangeComboBox.setGeometry(QtCore.QRect(60*widthRatio, 90*heightRatio, 69*widthRatio, 16*heightRatio))
        self.dRangeComboBox.setObjectName("dRangeComboBox")
        self.dRangeComboBox.addItem("")
        self.dRangeComboBox.addItem("")
        self.dRangeComboBox.addItem("")
        self.dRangeComboBox.addItem("")
        self.dRangeComboBox.addItem("")
        self.dRangeComboBox.addItem("")
        self.dRangeComboBox.addItem("")
        self.dRangeComboBox.addItem("")
        self.dRangeComboBox.addItem("")
        self.dRangeComboBox.addItem("")
        self.dRangeComboBox.addItem("")
        self.dRangeComboBox.addItem("")
        self.aOffsetSpinBox = QtWidgets.QDoubleSpinBox(self.channelBox)
        self.aOffsetSpinBox.setGeometry(QtCore.QRect(150*widthRatio, 30*heightRatio, 62*widthRatio, 16*heightRatio))
        self.aOffsetSpinBox.setMaximum(999999.0)
        self.aOffsetSpinBox.setObjectName("aOffsetSpinBox")
        self.bOffsetSpinBox = QtWidgets.QDoubleSpinBox(self.channelBox)
        self.bOffsetSpinBox.setGeometry(QtCore.QRect(150*widthRatio, 50*heightRatio, 62*widthRatio, 16*heightRatio))
        self.bOffsetSpinBox.setMaximum(999999.0)
        self.bOffsetSpinBox.setObjectName("bOffsetSpinBox")
        self.cOffsetSpinBox = QtWidgets.QDoubleSpinBox(self.channelBox)
        self.cOffsetSpinBox.setGeometry(QtCore.QRect(150*widthRatio, 70*heightRatio, 62*widthRatio, 16*heightRatio))
        self.cOffsetSpinBox.setMaximum(999999.0)
        self.cOffsetSpinBox.setObjectName("cOffsetSpinBox")
        self.dOffsetSpinBox = QtWidgets.QDoubleSpinBox(self.channelBox)
        self.dOffsetSpinBox.setGeometry(QtCore.QRect(150*widthRatio, 90*heightRatio, 62*widthRatio, 16*heightRatio))
        self.dOffsetSpinBox.setMaximum(999999.0)
        self.dOffsetSpinBox.setObjectName("dOffsetSpinBox")
        self.rangeLabel = QtWidgets.QLabel(self.channelBox)
        self.rangeLabel.setGeometry(QtCore.QRect(80*widthRatio, 10*heightRatio, 47*widthRatio, 13*heightRatio))
        self.rangeLabel.setObjectName("rangeLabel")
        self.offsetLabel = QtWidgets.QLabel(self.channelBox)
        self.offsetLabel.setGeometry(QtCore.QRect(160*widthRatio, 10*heightRatio, 47*widthRatio, 13*heightRatio))
        self.offsetLabel.setObjectName("offsetLabel")
        self.couplingLabel = QtWidgets.QLabel(self.channelBox)
        self.couplingLabel.setGeometry(QtCore.QRect(230*widthRatio, 10*heightRatio, 47*widthRatio, 13*heightRatio))
        self.couplingLabel.setObjectName("couplingLabel")
        self.aCouplingComboBox = QtWidgets.QComboBox(self.channelBox)
        self.aCouplingComboBox.setGeometry(QtCore.QRect(230*widthRatio, 30*heightRatio, 41*widthRatio, 16*heightRatio))
        self.aCouplingComboBox.setObjectName("aCouplingComboBox")
        self.aCouplingComboBox.addItem("")
        self.aCouplingComboBox.addItem("")
        self.bCouplingComboBox = QtWidgets.QComboBox(self.channelBox)
        self.bCouplingComboBox.setGeometry(QtCore.QRect(230*widthRatio, 50*heightRatio, 41*widthRatio, 16*heightRatio))
        self.bCouplingComboBox.setObjectName("bCouplingComboBox")
        self.bCouplingComboBox.addItem("")
        self.bCouplingComboBox.addItem("")
        self.cCouplingComboBox = QtWidgets.QComboBox(self.channelBox)
        self.cCouplingComboBox.setGeometry(QtCore.QRect(230*widthRatio, 70*heightRatio, 41*widthRatio, 16*heightRatio))
        self.cCouplingComboBox.setObjectName("cCouplingComboBox")
        self.cCouplingComboBox.addItem("")
        self.cCouplingComboBox.addItem("")
        self.dCouplingComboBox = QtWidgets.QComboBox(self.channelBox)
        self.dCouplingComboBox.setGeometry(QtCore.QRect(230*widthRatio, 90*heightRatio, 41*widthRatio, 16*heightRatio))
        self.dCouplingComboBox.setObjectName("dCouplingComboBox")
        self.dCouplingComboBox.addItem("")
        self.dCouplingComboBox.addItem("")
        self.captureBox = QtWidgets.QGroupBox(self.centralwidget)
        self.captureBox.setGeometry(QtCore.QRect(500*widthRatio, 0*heightRatio, 291*widthRatio, 121*heightRatio))
        self.captureBox.setObjectName("captureBox")
        self.modeComboBox = QtWidgets.QComboBox(self.captureBox)
        self.modeComboBox.setGeometry(QtCore.QRect(40*widthRatio, 20*heightRatio, 81*widthRatio, 22*heightRatio))
        self.modeComboBox.setObjectName("modeComboBox")
        self.modeComboBox.addItem("")
        self.modeComboBox.addItem("")
        self.modeComboBox.addItem("")
        self.modeLabel = QtWidgets.QLabel(self.captureBox)
        self.modeLabel.setGeometry(QtCore.QRect(10*widthRatio, 20*heightRatio, 31*widthRatio, 21*heightRatio))
        self.modeLabel.setObjectName("modeLabel")
        self.preTriggerSamplesLabel = QtWidgets.QLabel(self.captureBox)
        self.preTriggerSamplesLabel.setGeometry(QtCore.QRect(130*widthRatio, 50*heightRatio, 101*widthRatio, 16*heightRatio))
        self.preTriggerSamplesLabel.setObjectName("preTriggerSamplesLabel")
        self.postTriggerSamplesLabel = QtWidgets.QLabel(self.captureBox)
        self.postTriggerSamplesLabel.setGeometry(QtCore.QRect(130*widthRatio, 70*heightRatio, 101*widthRatio, 16*heightRatio))
        self.postTriggerSamplesLabel.setObjectName("postTriggerSamplesLabel")
        self.preTriggerSamplesSpinBox = QtWidgets.QSpinBox(self.captureBox)
        self.preTriggerSamplesSpinBox.setEnabled(True)
        self.preTriggerSamplesSpinBox.setGeometry(QtCore.QRect(231*widthRatio, 50*heightRatio, 51*widthRatio, 16*heightRatio))
        self.preTriggerSamplesSpinBox.setAutoFillBackground(False)
        self.preTriggerSamplesSpinBox.setReadOnly(False)
        self.preTriggerSamplesSpinBox.setProperty("showGroupSeparator", False)
        self.preTriggerSamplesSpinBox.setMaximum(999999)
        self.preTriggerSamplesSpinBox.setObjectName("preTriggerSamplesSpinBox")
        self.postTriggerSamplesSpinBox = QtWidgets.QSpinBox(self.captureBox)
        self.postTriggerSamplesSpinBox.setGeometry(QtCore.QRect(231*widthRatio, 70*heightRatio, 51*widthRatio, 16*heightRatio))
        self.postTriggerSamplesSpinBox.setMaximum(999999)
        self.postTriggerSamplesSpinBox.setObjectName("postTriggerSamplesSpinBox")
        self.timebaseLabel = QtWidgets.QLabel(self.captureBox)
        self.timebaseLabel.setGeometry(QtCore.QRect(10*widthRatio, 50*heightRatio, 47*widthRatio, 13*heightRatio))
        self.timebaseLabel.setObjectName("timebaseLabel")
        self.timebaseSpinBox = QtWidgets.QSpinBox(self.captureBox)
        self.timebaseSpinBox.setGeometry(QtCore.QRect(60*widthRatio, 50*heightRatio, 42*widthRatio, 16*heightRatio))
        self.timebaseSpinBox.setMaximum(999999)
        self.timebaseSpinBox.setObjectName("timebaseSpinBox")
        self.segmentsLabel = QtWidgets.QLabel(self.captureBox)
        self.segmentsLabel.setGeometry(QtCore.QRect(10*widthRatio, 70*heightRatio, 47*widthRatio, 13*heightRatio))
        self.segmentsLabel.setObjectName("segmentsLabel")
        self.capturesLabel = QtWidgets.QLabel(self.captureBox)
        self.capturesLabel.setGeometry(QtCore.QRect(10*widthRatio, 90*heightRatio, 47*widthRatio, 13*heightRatio))
        self.capturesLabel.setObjectName("capturesLabel")
        self.segmentsSpinBox = QtWidgets.QSpinBox(self.captureBox)
        self.segmentsSpinBox.setGeometry(QtCore.QRect(60*widthRatio, 70*heightRatio, 42*widthRatio, 16*heightRatio))
        self.segmentsSpinBox.setMaximum(999999)
        self.segmentsSpinBox.setObjectName("segmentsSpinBox")
        self.capturesSpinBox = QtWidgets.QSpinBox(self.captureBox)
        self.capturesSpinBox.setGeometry(QtCore.QRect(60*widthRatio, 90*heightRatio, 42*widthRatio, 16*heightRatio))
        self.capturesSpinBox.setMaximum(999999)
        self.capturesSpinBox.setObjectName("capturesSpinBox")
        self.timeUnitsLabel = QtWidgets.QLabel(self.captureBox)
        self.timeUnitsLabel.setGeometry(QtCore.QRect(130*widthRatio, 30*heightRatio, 71*widthRatio, 16*heightRatio))
        self.timeUnitsLabel.setObjectName("timeUnitsLabel")
        self.totalRuntimeLabel = QtWidgets.QLabel(self.captureBox)
        self.totalRuntimeLabel.setGeometry(QtCore.QRect(130*widthRatio, 10*heightRatio, 81*widthRatio, 16*heightRatio))
        self.totalRuntimeLabel.setObjectName("totalRuntimeLabel")
        self.totalRuntimeSpinBox = QtWidgets.QSpinBox(self.captureBox)
        self.totalRuntimeSpinBox.setGeometry(QtCore.QRect(201*widthRatio, 10*heightRatio, 81*widthRatio, 16*heightRatio))
        self.totalRuntimeSpinBox.setMaximum(999999999)
        self.totalRuntimeSpinBox.setObjectName("totalRuntimeSpinBox")
        self.timeUnitsComboBox = QtWidgets.QComboBox(self.captureBox)
        self.timeUnitsComboBox.setGeometry(QtCore.QRect(210*widthRatio, 30*heightRatio, 69*widthRatio, 16*heightRatio))
        self.timeUnitsComboBox.setObjectName("timeUnitsComboBox")
        self.timeUnitsComboBox.addItem("")
        self.timeUnitsComboBox.addItem("")
        self.timeUnitsComboBox.addItem("")
        self.timeUnitsComboBox.addItem("")
        self.timeUnitsComboBox.addItem("")
        self.timeUnitsComboBox.addItem("")
        self.samplesPerBufferLabel = QtWidgets.QLabel(self.captureBox)
        self.samplesPerBufferLabel.setGeometry(QtCore.QRect(130*widthRatio, 90*heightRatio, 101*widthRatio, 16*heightRatio))
        self.samplesPerBufferLabel.setObjectName("samplesPerBufferLabel")
        self.samplesPerBufferSpinBox = QtWidgets.QSpinBox(self.captureBox)
        self.samplesPerBufferSpinBox.setGeometry(QtCore.QRect(231*widthRatio, 90*heightRatio, 51*widthRatio, 16*heightRatio))
        self.samplesPerBufferSpinBox.setMaximum(999999)
        self.samplesPerBufferSpinBox.setObjectName("samplesPerBufferSpinBox")
        self.driverLineEdit = QtWidgets.QLineEdit(self.centralwidget)
        self.driverLineEdit.setGeometry(QtCore.QRect(60*widthRatio, 10*heightRatio, 71*widthRatio, 22*heightRatio))
        self.driverLineEdit.setReadOnly(True)
        self.driverLineEdit.setObjectName("driverLineEdit")
        self.outFileCheckBox = QtWidgets.QCheckBox(self.centralwidget)
        self.outFileCheckBox.setGeometry(QtCore.QRect(30*widthRatio, 80*heightRatio, 81*widthRatio, 17*heightRatio))
        self.outFileCheckBox.setObjectName("outFileCheckBox")
        self.outFileNameLineEdit = QtWidgets.QLineEdit(self.centralwidget)
        self.outFileNameLineEdit.setGeometry(QtCore.QRect(30*widthRatio, 100*heightRatio, 113*widthRatio, 20*heightRatio))
        self.outFileNameLineEdit.setObjectName("outFileNameLineEdit")
        self.triggerBox = QtWidgets.QGroupBox(self.centralwidget)
        self.triggerBox.setGeometry(QtCore.QRect(500*widthRatio, 130*heightRatio, 291*widthRatio, 391*heightRatio))
        self.triggerBox.setObjectName("triggerBox")
        self.triggerTypeLabel = QtWidgets.QLabel(self.triggerBox)
        self.triggerTypeLabel.setGeometry(QtCore.QRect(10*widthRatio, 20*heightRatio, 47*widthRatio, 16*heightRatio))
        self.triggerTypeLabel.setObjectName("triggerTypeLabel")
        self.triggerTypeComboBox = QtWidgets.QComboBox(self.triggerBox)
        self.triggerTypeComboBox.setGeometry(QtCore.QRect(40*widthRatio, 20*heightRatio, 69*widthRatio, 21*heightRatio))
        self.triggerTypeComboBox.setObjectName("triggerTypeComboBox")
        self.triggerTypeComboBox.addItem("")
        self.triggerTypeComboBox.addItem("")
        self.aAutotriggerSpinBox = QtWidgets.QSpinBox(self.triggerBox)
        self.aAutotriggerSpinBox.setGeometry(QtCore.QRect(231*widthRatio, 10*heightRatio, 51*widthRatio, 16*heightRatio))
        self.aAutotriggerSpinBox.setMaximum(999999)
        self.aAutotriggerSpinBox.setObjectName("aAutotriggerSpinBox")
        self.aDelaySpinBox = QtWidgets.QSpinBox(self.triggerBox)
        self.aDelaySpinBox.setGeometry(QtCore.QRect(231*widthRatio, 30*heightRatio, 51*widthRatio, 16*heightRatio))
        self.aDelaySpinBox.setMaximum(999999)
        self.aDelaySpinBox.setObjectName("aDelaySpinBox")
        self.triggerAutotriggerLabel = QtWidgets.QLabel(self.triggerBox)
        self.triggerAutotriggerLabel.setGeometry(QtCore.QRect(160*widthRatio, 10*heightRatio, 71*widthRatio, 21*heightRatio))
        self.triggerAutotriggerLabel.setObjectName("triggerAutotriggerLabel")
        self.triggerDelayLabel = QtWidgets.QLabel(self.triggerBox)
        self.triggerDelayLabel.setGeometry(QtCore.QRect(190*widthRatio, 30*heightRatio, 41*widthRatio, 16*heightRatio))
        self.triggerDelayLabel.setObjectName("triggerDelayLabel")
        self.cUpperThresholdSpinBox = QtWidgets.QSpinBox(self.triggerBox)
        self.cUpperThresholdSpinBox.setGeometry(QtCore.QRect(51*widthRatio, 120*heightRatio, 51*widthRatio, 16*heightRatio))
        self.cUpperThresholdSpinBox.setMaximum(32512)
        self.cUpperThresholdSpinBox.setObjectName("cUpperThresholdSpinBox")
        self.dUpperThresholdSpinBox = QtWidgets.QSpinBox(self.triggerBox)
        self.dUpperThresholdSpinBox.setGeometry(QtCore.QRect(51*widthRatio, 140*heightRatio, 51*widthRatio, 16*heightRatio))
        self.dUpperThresholdSpinBox.setMaximum(32512)
        self.dUpperThresholdSpinBox.setObjectName("dUpperThresholdSpinBox")
        self.aUpperThresholdSpinBox = QtWidgets.QSpinBox(self.triggerBox)
        self.aUpperThresholdSpinBox.setGeometry(QtCore.QRect(51*widthRatio, 80*heightRatio, 51*widthRatio, 16*heightRatio))
        self.aUpperThresholdSpinBox.setMaximum(32512)
        self.aUpperThresholdSpinBox.setObjectName("aUpperThresholdSpinBox")
        self.cTriggerCheck = QtWidgets.QCheckBox(self.triggerBox)
        self.cTriggerCheck.setGeometry(QtCore.QRect(30*widthRatio, 120*heightRatio, 16*widthRatio, 17*heightRatio))
        self.cTriggerCheck.setText("")
        self.cTriggerCheck.setObjectName("cTriggerCheck")
        self.aTriggerCheck = QtWidgets.QCheckBox(self.triggerBox)
        self.aTriggerCheck.setGeometry(QtCore.QRect(30*widthRatio, 80*heightRatio, 16*widthRatio, 17*heightRatio))
        self.aTriggerCheck.setText("")
        self.aTriggerCheck.setObjectName("aTriggerCheck")
        self.bTriggerLabel = QtWidgets.QLabel(self.triggerBox)
        self.bTriggerLabel.setGeometry(QtCore.QRect(10*widthRatio, 100*heightRatio, 16*widthRatio, 16*heightRatio))
        self.bTriggerLabel.setObjectName("bTriggerLabel")
        self.bUpperThresholdSpinBox = QtWidgets.QSpinBox(self.triggerBox)
        self.bUpperThresholdSpinBox.setGeometry(QtCore.QRect(51*widthRatio, 100*heightRatio, 51*widthRatio, 16*heightRatio))
        self.bUpperThresholdSpinBox.setMaximum(32512)
        self.bUpperThresholdSpinBox.setObjectName("bUpperThresholdSpinBox")
        self.aTriggerLabel = QtWidgets.QLabel(self.triggerBox)
        self.aTriggerLabel.setGeometry(QtCore.QRect(10*widthRatio, 80*heightRatio, 16*widthRatio, 16*heightRatio))
        self.aTriggerLabel.setObjectName("aTriggerLabel")
        self.cTriggerLabel = QtWidgets.QLabel(self.triggerBox)
        self.cTriggerLabel.setGeometry(QtCore.QRect(10*widthRatio, 120*heightRatio, 16*widthRatio, 16*heightRatio))
        self.cTriggerLabel.setObjectName("cTriggerLabel")
        self.dTriggerCheck = QtWidgets.QCheckBox(self.triggerBox)
        self.dTriggerCheck.setGeometry(QtCore.QRect(30*widthRatio, 140*heightRatio, 16*widthRatio, 17*heightRatio))
        self.dTriggerCheck.setText("")
        self.dTriggerCheck.setObjectName("dTriggerCheck")
        self.triggerUpperThresholdLabel = QtWidgets.QLabel(self.triggerBox)
        self.triggerUpperThresholdLabel.setGeometry(QtCore.QRect(50*widthRatio, 50*heightRatio, 51*widthRatio, 31*heightRatio))
        self.triggerUpperThresholdLabel.setWordWrap(True)
        self.triggerUpperThresholdLabel.setObjectName("triggerUpperThresholdLabel")
        self.dTriggerLabel = QtWidgets.QLabel(self.triggerBox)
        self.dTriggerLabel.setGeometry(QtCore.QRect(10*widthRatio, 140*heightRatio, 16*widthRatio, 16*heightRatio))
        self.dTriggerLabel.setObjectName("dTriggerLabel")
        self.bTriggerCheck = QtWidgets.QCheckBox(self.triggerBox)
        self.bTriggerCheck.setGeometry(QtCore.QRect(30*widthRatio, 100*heightRatio, 16*widthRatio, 17*heightRatio))
        self.bTriggerCheck.setText("")
        self.bTriggerCheck.setObjectName("bTriggerCheck")
        self.deleteConditionButton = QtWidgets.QPushButton(self.triggerBox)
        self.deleteConditionButton.setGeometry(QtCore.QRect(100*widthRatio, 340*heightRatio, 91*widthRatio, 23*heightRatio))
        self.deleteConditionButton.setObjectName("deleteConditionButton")
        self.newConditionButton = QtWidgets.QPushButton(self.triggerBox)
        self.newConditionButton.setGeometry(QtCore.QRect(10*widthRatio, 340*heightRatio, 81*widthRatio, 21*heightRatio))
        self.newConditionButton.setObjectName("newConditionButton")
        self.conditionsTabWidget = QtWidgets.QTabWidget(self.triggerBox)
        self.conditionsTabWidget.setEnabled(True)
        self.conditionsTabWidget.setGeometry(QtCore.QRect(10*widthRatio, 180*heightRatio, 121*widthRatio, 151*heightRatio))
        self.conditionsTabWidget.setObjectName("conditionsTabWidget")
        self.newCondition()
        self.dUpperHysteresisSpinBox = QtWidgets.QSpinBox(self.triggerBox)
        self.dUpperHysteresisSpinBox.setGeometry(QtCore.QRect(111*widthRatio, 140*heightRatio, 51*widthRatio, 16*heightRatio))
        self.dUpperHysteresisSpinBox.setMaximum(32512)
        self.dUpperHysteresisSpinBox.setObjectName("dUpperHysteresisSpinBox")
        self.bUpperHysteresisSpinBox = QtWidgets.QSpinBox(self.triggerBox)
        self.bUpperHysteresisSpinBox.setGeometry(QtCore.QRect(111*widthRatio, 100*heightRatio, 51*widthRatio, 16*heightRatio))
        self.bUpperHysteresisSpinBox.setMaximum(32512)
        self.bUpperHysteresisSpinBox.setObjectName("bUpperHysteresisSpinBox")
        self.triggerUpperHysteresisLabel = QtWidgets.QLabel(self.triggerBox)
        self.triggerUpperHysteresisLabel.setGeometry(QtCore.QRect(110*widthRatio, 50*heightRatio, 51*widthRatio, 31*heightRatio))
        self.triggerUpperHysteresisLabel.setWordWrap(True)
        self.triggerUpperHysteresisLabel.setObjectName("triggerUpperHysteresisLabel")
        self.aUpperHysteresisSpinBox = QtWidgets.QSpinBox(self.triggerBox)
        self.aUpperHysteresisSpinBox.setGeometry(QtCore.QRect(111*widthRatio, 80*heightRatio, 51*widthRatio, 16*heightRatio))
        self.aUpperHysteresisSpinBox.setMaximum(32512)
        self.aUpperHysteresisSpinBox.setObjectName("aUpperHysteresisSpinBox")
        self.cUpperHysteresisSpinBox = QtWidgets.QSpinBox(self.triggerBox)
        self.cUpperHysteresisSpinBox.setGeometry(QtCore.QRect(111*widthRatio, 120*heightRatio, 51*widthRatio, 16*heightRatio))
        self.cUpperHysteresisSpinBox.setMaximum(32512)
        self.cUpperHysteresisSpinBox.setObjectName("cUpperHysteresisSpinBox")
        self.dLowerThresholdSpinBox = QtWidgets.QSpinBox(self.triggerBox)
        self.dLowerThresholdSpinBox.setGeometry(QtCore.QRect(171*widthRatio, 140*heightRatio, 51*widthRatio, 16*heightRatio))
        self.dLowerThresholdSpinBox.setMaximum(32512)
        self.dLowerThresholdSpinBox.setObjectName("dLowerThresholdSpinBox")
        self.dLowerHysteresisSpinBox = QtWidgets.QSpinBox(self.triggerBox)
        self.dLowerHysteresisSpinBox.setGeometry(QtCore.QRect(231*widthRatio, 140*heightRatio, 51*widthRatio, 16*heightRatio))
        self.dLowerHysteresisSpinBox.setMaximum(32512)
        self.dLowerHysteresisSpinBox.setObjectName("dLowerHysteresisSpinBox")
        self.triggerLowerHysteresisLabel = QtWidgets.QLabel(self.triggerBox)
        self.triggerLowerHysteresisLabel.setGeometry(QtCore.QRect(230*widthRatio, 50*heightRatio, 51*widthRatio, 31*heightRatio))
        self.triggerLowerHysteresisLabel.setWordWrap(True)
        self.triggerLowerHysteresisLabel.setObjectName("triggerLowerHysteresisLabel")
        self.aLowerHysteresisSpinBox = QtWidgets.QSpinBox(self.triggerBox)
        self.aLowerHysteresisSpinBox.setGeometry(QtCore.QRect(231*widthRatio, 80*heightRatio, 51*widthRatio, 16*heightRatio))
        self.aLowerHysteresisSpinBox.setMaximum(32512)
        self.aLowerHysteresisSpinBox.setObjectName("aLowerHysteresisSpinBox")
        self.bLowerThresholdSpinBox = QtWidgets.QSpinBox(self.triggerBox)
        self.bLowerThresholdSpinBox.setGeometry(QtCore.QRect(171*widthRatio, 100*heightRatio, 51*widthRatio, 16*heightRatio))
        self.bLowerThresholdSpinBox.setMaximum(32512)
        self.bLowerThresholdSpinBox.setObjectName("bLowerThresholdSpinBox")
        self.bLowerHysteresisSpinBox = QtWidgets.QSpinBox(self.triggerBox)
        self.bLowerHysteresisSpinBox.setGeometry(QtCore.QRect(231*widthRatio, 100*heightRatio, 51*widthRatio, 16*heightRatio))
        self.bLowerHysteresisSpinBox.setMaximum(32512)
        self.bLowerHysteresisSpinBox.setObjectName("bLowerHysteresisSpinBox")
        self.cLowerHysteresisSpinBox = QtWidgets.QSpinBox(self.triggerBox)
        self.cLowerHysteresisSpinBox.setGeometry(QtCore.QRect(231*widthRatio, 120*heightRatio, 51*widthRatio, 16*heightRatio))
        self.cLowerHysteresisSpinBox.setMaximum(32512)
        self.cLowerHysteresisSpinBox.setObjectName("cLowerHysteresisSpinBox")
        self.triggerLowerThresholdLabel = QtWidgets.QLabel(self.triggerBox)
        self.triggerLowerThresholdLabel.setGeometry(QtCore.QRect(170*widthRatio, 50*heightRatio, 51*widthRatio, 31*heightRatio))
        self.triggerLowerThresholdLabel.setWordWrap(True)
        self.triggerLowerThresholdLabel.setObjectName("triggerLowerThresholdLabel")
        self.aLowerThresholdSpinBox = QtWidgets.QSpinBox(self.triggerBox)
        self.aLowerThresholdSpinBox.setGeometry(QtCore.QRect(171*widthRatio, 80*heightRatio, 51*widthRatio, 16*heightRatio))
        self.aLowerThresholdSpinBox.setMaximum(32512)
        self.aLowerThresholdSpinBox.setObjectName("aLowerThresholdSpinBox")
        self.cLowerThresholdSpinBox = QtWidgets.QSpinBox(self.triggerBox)
        self.cLowerThresholdSpinBox.setGeometry(QtCore.QRect(171*widthRatio, 120*heightRatio, 51*widthRatio, 16*heightRatio))
        self.cLowerThresholdSpinBox.setMaximum(32512)
        self.cLowerThresholdSpinBox.setObjectName("cLowerThresholdSpinBox")
        self.extTriggerLabel = QtWidgets.QLabel(self.triggerBox)
        self.extTriggerLabel.setGeometry(QtCore.QRect(10*widthRatio, 160*heightRatio, 16*widthRatio, 16*heightRatio))
        self.extTriggerLabel.setObjectName("extTriggerLabel")
        self.extTriggerCheck = QtWidgets.QCheckBox(self.triggerBox)
        self.extTriggerCheck.setGeometry(QtCore.QRect(30*widthRatio, 160*heightRatio, 16*widthRatio, 17*heightRatio))
        self.extTriggerCheck.setText("")
        self.extTriggerCheck.setObjectName("extTriggerCheck")
        self.extUpperThresholdSpinBox = QtWidgets.QSpinBox(self.triggerBox)
        self.extUpperThresholdSpinBox.setGeometry(QtCore.QRect(51*widthRatio, 160*heightRatio, 51*widthRatio, 16*heightRatio))
        self.extUpperThresholdSpinBox.setMaximum(32767)
        self.extUpperThresholdSpinBox.setObjectName("extUpperThresholdSpinBox")
        self.extUpperHysteresisSpinBox = QtWidgets.QSpinBox(self.triggerBox)
        self.extUpperHysteresisSpinBox.setGeometry(QtCore.QRect(111*widthRatio, 160*heightRatio, 51*widthRatio, 16*heightRatio))
        self.extUpperHysteresisSpinBox.setMaximum(32767)
        self.extUpperHysteresisSpinBox.setObjectName("extUpperHysteresisSpinBox")
        self.extLowerThresholdSpinBox = QtWidgets.QSpinBox(self.triggerBox)
        self.extLowerThresholdSpinBox.setGeometry(QtCore.QRect(171*widthRatio, 160*heightRatio, 51*widthRatio, 16*heightRatio))
        self.extLowerThresholdSpinBox.setMaximum(32767)
        self.extLowerThresholdSpinBox.setObjectName("extLowerThresholdSpinBox")
        self.extLowerHysteresisSpinBox = QtWidgets.QSpinBox(self.triggerBox)
        self.extLowerHysteresisSpinBox.setGeometry(QtCore.QRect(231*widthRatio, 160*heightRatio, 51*widthRatio, 16*heightRatio))
        self.extLowerHysteresisSpinBox.setMaximum(32767)
        self.extLowerHysteresisSpinBox.setObjectName("extLowerHysteresisSpinBox")
        self.triggerDirectionLabel = QtWidgets.QLabel(self.triggerBox)
        self.triggerDirectionLabel.setGeometry(QtCore.QRect(140*widthRatio, 200*heightRatio, 47*widthRatio, 21*heightRatio))
        self.triggerDirectionLabel.setObjectName("triggerDirectionLabel")
        self.aThresholdModeComboBox = QtWidgets.QComboBox(self.triggerBox)
        self.aThresholdModeComboBox.setGeometry(QtCore.QRect(220*widthRatio, 220*heightRatio, 61*widthRatio, 16*heightRatio))
        self.aThresholdModeComboBox.setObjectName("aThresholdModeComboBox")
        self.aThresholdModeComboBox.addItem("")
        self.aThresholdModeComboBox.addItem("")
        self.bDirectionComboBox = QtWidgets.QComboBox(self.triggerBox)
        self.bDirectionComboBox.setGeometry(QtCore.QRect(140*widthRatio, 240*heightRatio, 71*widthRatio, 16*heightRatio))
        self.bDirectionComboBox.setObjectName("bDirectionComboBox")
        self.bDirectionComboBox.addItem("")
        self.bDirectionComboBox.addItem("")
        self.bDirectionComboBox.addItem("")
        self.bDirectionComboBox.addItem("")
        self.bDirectionComboBox.addItem("")
        self.bDirectionComboBox.addItem("")
        self.bDirectionComboBox.addItem("")
        self.bDirectionComboBox.addItem("")
        self.bDirectionComboBox.addItem("")
        self.bDirectionComboBox.addItem("")
        self.bDirectionComboBox.addItem("")
        self.extDirectionComboBox = QtWidgets.QComboBox(self.triggerBox)
        self.extDirectionComboBox.setGeometry(QtCore.QRect(140*widthRatio, 300*heightRatio, 71*widthRatio, 16*heightRatio))
        self.extDirectionComboBox.setObjectName("extDirectionComboBox")
        self.extDirectionComboBox.addItem("")
        self.extDirectionComboBox.addItem("")
        self.extDirectionComboBox.addItem("")
        self.extDirectionComboBox.addItem("")
        self.extDirectionComboBox.addItem("")
        self.extDirectionComboBox.addItem("")
        self.extDirectionComboBox.addItem("")
        self.extDirectionComboBox.addItem("")
        self.extDirectionComboBox.addItem("")
        self.extDirectionComboBox.addItem("")
        self.extDirectionComboBox.addItem("")
        self.dDirectionComboBox = QtWidgets.QComboBox(self.triggerBox)
        self.dDirectionComboBox.setGeometry(QtCore.QRect(140*widthRatio, 280*heightRatio, 71*widthRatio, 16*heightRatio))
        self.dDirectionComboBox.setObjectName("dDirectionComboBox")
        self.dDirectionComboBox.addItem("")
        self.dDirectionComboBox.addItem("")
        self.dDirectionComboBox.addItem("")
        self.dDirectionComboBox.addItem("")
        self.dDirectionComboBox.addItem("")
        self.dDirectionComboBox.addItem("")
        self.dDirectionComboBox.addItem("")
        self.dDirectionComboBox.addItem("")
        self.dDirectionComboBox.addItem("")
        self.dDirectionComboBox.addItem("")
        self.dDirectionComboBox.addItem("")
        self.thresholdModeLabel = QtWidgets.QLabel(self.triggerBox)
        self.thresholdModeLabel.setGeometry(QtCore.QRect(220*widthRatio, 200*heightRatio, 47*widthRatio, 21*heightRatio))
        self.thresholdModeLabel.setObjectName("thresholdModeLabel")
        self.cDirectionComboBox = QtWidgets.QComboBox(self.triggerBox)
        self.cDirectionComboBox.setGeometry(QtCore.QRect(140*widthRatio, 260*heightRatio, 71*widthRatio, 16*heightRatio))
        self.cDirectionComboBox.setObjectName("cDirectionComboBox")
        self.cDirectionComboBox.addItem("")
        self.cDirectionComboBox.addItem("")
        self.cDirectionComboBox.addItem("")
        self.cDirectionComboBox.addItem("")
        self.cDirectionComboBox.addItem("")
        self.cDirectionComboBox.addItem("")
        self.cDirectionComboBox.addItem("")
        self.cDirectionComboBox.addItem("")
        self.cDirectionComboBox.addItem("")
        self.cDirectionComboBox.addItem("")
        self.cDirectionComboBox.addItem("")
        self.aDirectionComboBox = QtWidgets.QComboBox(self.triggerBox)
        self.aDirectionComboBox.setGeometry(QtCore.QRect(140*widthRatio, 220*heightRatio, 71*widthRatio, 16*heightRatio))
        self.aDirectionComboBox.setObjectName("aDirectionComboBox")
        self.aDirectionComboBox.addItem("")
        self.aDirectionComboBox.addItem("")
        self.aDirectionComboBox.addItem("")
        self.aDirectionComboBox.addItem("")
        self.aDirectionComboBox.addItem("")
        self.aDirectionComboBox.addItem("")
        self.aDirectionComboBox.addItem("")
        self.aDirectionComboBox.addItem("")
        self.aDirectionComboBox.addItem("")
        self.aDirectionComboBox.addItem("")
        self.aDirectionComboBox.addItem("")
        self.dThresholdModeComboBox = QtWidgets.QComboBox(self.triggerBox)
        self.dThresholdModeComboBox.setGeometry(QtCore.QRect(220*widthRatio, 280*heightRatio, 61*widthRatio, 16*heightRatio))
        self.dThresholdModeComboBox.setObjectName("dThresholdModeComboBox")
        self.dThresholdModeComboBox.addItem("")
        self.dThresholdModeComboBox.addItem("")
        self.bThresholdModeComboBox = QtWidgets.QComboBox(self.triggerBox)
        self.bThresholdModeComboBox.setGeometry(QtCore.QRect(220*widthRatio, 240*heightRatio, 61*widthRatio, 16*heightRatio))
        self.bThresholdModeComboBox.setObjectName("bThresholdModeComboBox")
        self.bThresholdModeComboBox.addItem("")
        self.bThresholdModeComboBox.addItem("")
        self.extThresholdModeComboBox = QtWidgets.QComboBox(self.triggerBox)
        self.extThresholdModeComboBox.setGeometry(QtCore.QRect(220*widthRatio, 300*heightRatio, 61*widthRatio, 16*heightRatio))
        self.extThresholdModeComboBox.setObjectName("extThresholdModeComboBox")
        self.extThresholdModeComboBox.addItem("")
        self.extThresholdModeComboBox.addItem("")
        self.cThresholdModeComboBox = QtWidgets.QComboBox(self.triggerBox)
        self.cThresholdModeComboBox.setGeometry(QtCore.QRect(220*widthRatio, 260*heightRatio, 61*widthRatio, 16*heightRatio))
        self.cThresholdModeComboBox.setObjectName("cThresholdModeComboBox")
        self.cThresholdModeComboBox.addItem("")
        self.cThresholdModeComboBox.addItem("")
        self.runButton = QtWidgets.QPushButton(self.centralwidget)
        self.runButton.setGeometry(QtCore.QRect(720*widthRatio, 530*heightRatio, 75*widthRatio, 23*heightRatio))
        self.runButton.setObjectName("runButton")
        self.runsLabel = QtWidgets.QLabel(self.centralwidget)
        self.runsLabel.setGeometry(QtCore.QRect(120*widthRatio, 70*heightRatio, 47*widthRatio, 16*heightRatio))
        self.runsLabel.setObjectName("runsLabel")
        self.runsSpinBox = QtWidgets.QSpinBox(self.centralwidget)
        self.runsSpinBox.setGeometry(QtCore.QRect(160*widthRatio, 70*heightRatio, 42*widthRatio, 16*heightRatio))
        self.runsSpinBox.setObjectName("runsSpinBox")
        self.runsSpinBox.setMaximum(999999999)
        self.tabWidget = QtWidgets.QTabWidget(self.centralwidget)
        self.tabWidget.setGeometry(QtCore.QRect(20*widthRatio, 130*heightRatio, 471*widthRatio, 391*heightRatio))
        self.tabWidget.setObjectName("tabWidget")
        runList['runTab'].append(QtWidgets.QWidget())
        runList['runTab'][-1].setObjectName("run_1")
        runList['stackedWidget'].append(QtWidgets.QStackedWidget(runList['runTab'][-1]))
        runList['stackedWidget'][-1].setGeometry(QtCore.QRect(0*widthRatio, 0*heightRatio, 461*widthRatio, 361*heightRatio))
        runList['stackedWidget'][-1].setObjectName("stackedWidget_1")
        self.tabWidget.addTab(runList['runTab'][-1], "")
        MainWindow.setCentralWidget(self.centralwidget)
        self.menubar = QtWidgets.QMenuBar(MainWindow)
        self.menubar.setGeometry(QtCore.QRect(0*widthRatio, 0*heightRatio, 801*widthRatio, 21*heightRatio))
        self.menubar.setObjectName("menubar")
        self.menuPreset = QtWidgets.QMenu(self.menubar)
        self.menuPreset.setObjectName("menuPreset")
        MainWindow.setMenuBar(self.menubar)
        self.actionLoad_Preset = QtWidgets.QAction(MainWindow)
        self.actionLoad_Preset.setObjectName("actionLoad_Preset")
        self.actionSave_Preset = QtWidgets.QAction(MainWindow)
        self.actionSave_Preset.setObjectName("actionSave_Preset")
        self.menuPreset.addAction(self.actionSave_Preset)
        self.menuPreset.addAction(self.actionLoad_Preset)
        self.menubar.addAction(self.menuPreset.menuAction())

        self.nextPushButton = QtWidgets.QPushButton(self.centralwidget)
        self.nextPushButton.setGeometry(QtCore.QRect(260*widthRatio, 530*heightRatio, 75*widthRatio, 23*heightRatio))
        self.nextPushButton.setObjectName("nextPushButton")
        self.pageNumLineEdit = QtWidgets.QLineEdit(self.centralwidget)
        self.pageNumLineEdit.setGeometry(QtCore.QRect(232*widthRatio, 531*heightRatio, 21*widthRatio, 20*heightRatio))
        self.pageNumLineEdit.setObjectName("pageNumLineEdit")
        self.previousPushButton = QtWidgets.QPushButton(self.centralwidget)
        self.previousPushButton.setGeometry(QtCore.QRect(150*widthRatio, 530*heightRatio, 75*widthRatio, 23*heightRatio))
        self.previousPushButton.setObjectName("previousPushButton")

        self.graphCheck = QtWidgets.QCheckBox(self.centralwidget)
        self.graphCheck.setGeometry(QtCore.QRect(650*widthRatio, 530*heightRatio, 70*widthRatio, 21*heightRatio))
        self.graphCheck.setObjectName("graphCheck")

        self.retranslateUi(MainWindow)
        self.conditionsTabWidget.setCurrentIndex(0)
        self.tabWidget.setCurrentIndex(0)
        QtCore.QMetaObject.connectSlotsByName(MainWindow)

    def retranslateUi(self, MainWindow):
        _translate = QtCore.QCoreApplication.translate
        MainWindow.setWindowTitle(_translate("MainWindow", "Logger"))
        self.driverLabel.setText(_translate("MainWindow", "Driver"))
        self.presetComboBox.setItemText(0, _translate("MainWindow", "Manual"))
        self.presetLabel.setText(_translate("MainWindow", "Preset"))
        self.channelBox.setTitle(_translate("MainWindow", "Channels"))
        self.aLabel.setText(_translate("MainWindow", "A"))
        self.bLabel.setText(_translate("MainWindow", "B"))
        self.cLabel.setText(_translate("MainWindow", "C"))
        self.dLabel.setText(_translate("MainWindow", "D"))
        self.aRangeComboBox.setItemText(0, _translate("MainWindow", "10 mV"))
        self.aRangeComboBox.setItemText(1, _translate("MainWindow", "20 mV"))
        self.aRangeComboBox.setItemText(2, _translate("MainWindow", "50 mV"))
        self.aRangeComboBox.setItemText(3, _translate("MainWindow", "100 mV"))
        self.aRangeComboBox.setItemText(4, _translate("MainWindow", "200 mV"))
        self.aRangeComboBox.setItemText(5, _translate("MainWindow", "500 mV"))
        self.aRangeComboBox.setItemText(6, _translate("MainWindow", "1 V"))
        self.aRangeComboBox.setItemText(7, _translate("MainWindow", "2 V"))
        self.aRangeComboBox.setItemText(8, _translate("MainWindow", "5 V"))
        self.aRangeComboBox.setItemText(9, _translate("MainWindow", "10 V"))
        self.aRangeComboBox.setItemText(10, _translate("MainWindow", "20 V"))
        self.aRangeComboBox.setItemText(11, _translate("MainWindow", "50 V"))
        self.bRangeComboBox.setItemText(0, _translate("MainWindow", "10 mV"))
        self.bRangeComboBox.setItemText(1, _translate("MainWindow", "20 mV"))
        self.bRangeComboBox.setItemText(2, _translate("MainWindow", "50 mV"))
        self.bRangeComboBox.setItemText(3, _translate("MainWindow", "100 mV"))
        self.bRangeComboBox.setItemText(4, _translate("MainWindow", "200 mV"))
        self.bRangeComboBox.setItemText(5, _translate("MainWindow", "500 mV"))
        self.bRangeComboBox.setItemText(6, _translate("MainWindow", "1 V"))
        self.bRangeComboBox.setItemText(7, _translate("MainWindow", "2 V"))
        self.bRangeComboBox.setItemText(8, _translate("MainWindow", "5 V"))
        self.bRangeComboBox.setItemText(9, _translate("MainWindow", "10 V"))
        self.bRangeComboBox.setItemText(10, _translate("MainWindow", "20 V"))
        self.bRangeComboBox.setItemText(11, _translate("MainWindow", "50 V"))
        self.cRangeComboBox.setItemText(0, _translate("MainWindow", "10 mV"))
        self.cRangeComboBox.setItemText(1, _translate("MainWindow", "20 mV"))
        self.cRangeComboBox.setItemText(2, _translate("MainWindow", "50 mV"))
        self.cRangeComboBox.setItemText(3, _translate("MainWindow", "100 mV"))
        self.cRangeComboBox.setItemText(4, _translate("MainWindow", "200 mV"))
        self.cRangeComboBox.setItemText(5, _translate("MainWindow", "500 mV"))
        self.cRangeComboBox.setItemText(6, _translate("MainWindow", "1 V"))
        self.cRangeComboBox.setItemText(7, _translate("MainWindow", "2 V"))
        self.cRangeComboBox.setItemText(8, _translate("MainWindow", "5 V"))
        self.cRangeComboBox.setItemText(9, _translate("MainWindow", "10 V"))
        self.cRangeComboBox.setItemText(10, _translate("MainWindow", "20 V"))
        self.cRangeComboBox.setItemText(11, _translate("MainWindow", "50 V"))
        self.dRangeComboBox.setItemText(0, _translate("MainWindow", "10 mV"))
        self.dRangeComboBox.setItemText(1, _translate("MainWindow", "20 mV"))
        self.dRangeComboBox.setItemText(2, _translate("MainWindow", "50 mV"))
        self.dRangeComboBox.setItemText(3, _translate("MainWindow", "100 mV"))
        self.dRangeComboBox.setItemText(4, _translate("MainWindow", "200 mV"))
        self.dRangeComboBox.setItemText(5, _translate("MainWindow", "500 mV"))
        self.dRangeComboBox.setItemText(6, _translate("MainWindow", "1 V"))
        self.dRangeComboBox.setItemText(7, _translate("MainWindow", "2 V"))
        self.dRangeComboBox.setItemText(8, _translate("MainWindow", "5 V"))
        self.dRangeComboBox.setItemText(9, _translate("MainWindow", "10 V"))
        self.dRangeComboBox.setItemText(10, _translate("MainWindow", "20 V"))
        self.dRangeComboBox.setItemText(11, _translate("MainWindow", "50 V"))
        self.aCouplingComboBox.setItemText(0, _translate("MainWindow", "AC"))
        self.aCouplingComboBox.setItemText(1, _translate("MainWindow", "DC"))
        self.bCouplingComboBox.setItemText(0, _translate("MainWindow", "AC"))
        self.bCouplingComboBox.setItemText(1, _translate("MainWindow", "DC"))
        self.cCouplingComboBox.setItemText(0, _translate("MainWindow", "AC"))
        self.cCouplingComboBox.setItemText(1, _translate("MainWindow", "DC"))
        self.dCouplingComboBox.setItemText(0, _translate("MainWindow", "AC"))
        self.dCouplingComboBox.setItemText(1, _translate("MainWindow", "DC"))
        self.rangeLabel.setText(_translate("MainWindow", "Range"))
        self.offsetLabel.setText(_translate("MainWindow", "Offset"))
        self.couplingLabel.setText(_translate("MainWindow", "Coupling"))
        self.captureBox.setTitle(_translate("MainWindow", "Capture"))
        self.modeComboBox.setItemText(0, _translate("MainWindow", "Block"))
        self.modeComboBox.setItemText(1, _translate("MainWindow", "Rapid Block"))
        self.modeComboBox.setItemText(2, _translate("MainWindow", "Streaming"))
        self.modeLabel.setText(_translate("MainWindow", "Mode"))
        self.preTriggerSamplesLabel.setText(_translate("MainWindow", "Pre Trigger Samples"))
        self.postTriggerSamplesLabel.setText(_translate("MainWindow", "Post Trigger Samples"))
        self.timebaseLabel.setText(_translate("MainWindow", "Timebase"))
        self.segmentsLabel.setText(_translate("MainWindow", "Segments"))
        self.capturesLabel.setText(_translate("MainWindow", "Captures"))
        self.timeUnitsLabel.setText(_translate("MainWindow", "Time Units"))
        self.totalRuntimeLabel.setText(_translate("MainWindow", "Total Runtime"))
        self.timeUnitsComboBox.setItemText(0, _translate("MainWindow", "fs"))
        self.timeUnitsComboBox.setItemText(1, _translate("MainWindow", "ps"))
        self.timeUnitsComboBox.setItemText(2, _translate("MainWindow", "ns"))
        self.timeUnitsComboBox.setItemText(3, _translate("MainWindow", "Î¼s"))
        self.timeUnitsComboBox.setItemText(4, _translate("MainWindow", "ms"))
        self.timeUnitsComboBox.setItemText(5, _translate("MainWindow", "s"))
        self.samplesPerBufferLabel.setText(_translate("MainWindow", "Samples per Buffer"))
        self.outFileCheckBox.setText(_translate("MainWindow", "File Output"))
        self.triggerBox.setTitle(_translate("MainWindow", "Trigger"))
        self.triggerTypeLabel.setText(_translate("MainWindow", "Type"))
        self.triggerTypeComboBox.setItemText(0, _translate("MainWindow", "Simple"))
        self.triggerTypeComboBox.setItemText(1, _translate("MainWindow", "Complex"))
        self.triggerAutotriggerLabel.setText(_translate("MainWindow", "Auto-Trigger"))
        self.triggerDelayLabel.setText(_translate("MainWindow", "Delay"))
        self.bTriggerLabel.setText(_translate("MainWindow", "B"))
        self.aTriggerLabel.setText(_translate("MainWindow", "A"))
        self.cTriggerLabel.setText(_translate("MainWindow", "C"))
        self.triggerUpperThresholdLabel.setText(_translate("MainWindow", "Upper Threshold"))
        self.dTriggerLabel.setText(_translate("MainWindow", "D"))
        self.deleteConditionButton.setText(_translate("MainWindow", "Delete Condition"))
        self.newConditionButton.setText(_translate("MainWindow", "New Condition"))
        self.triggerUpperHysteresisLabel.setText(_translate("MainWindow", "Upper Hysteresis"))
        self.triggerLowerHysteresisLabel.setText(_translate("MainWindow", "Lower Hysteresis"))
        self.triggerLowerThresholdLabel.setText(_translate("MainWindow", "Lower Threshold"))
        self.extTriggerLabel.setText(_translate("MainWindow", "Ext"))
        self.triggerDirectionLabel.setText(_translate("MainWindow", "Direction"))
        self.aThresholdModeComboBox.setItemText(0, _translate("MainWindow", "Level"))
        self.aThresholdModeComboBox.setItemText(1, _translate("MainWindow", "Window"))
        self.bDirectionComboBox.setItemText(0, _translate("MainWindow", "Above"))
        self.bDirectionComboBox.setItemText(1, _translate("MainWindow", "Below"))
        self.bDirectionComboBox.setItemText(2, _translate("MainWindow", "Rising"))
        self.bDirectionComboBox.setItemText(3, _translate("MainWindow", "Falling"))
        self.bDirectionComboBox.setItemText(4, _translate("MainWindow", "Rising or Falling"))
        self.bDirectionComboBox.setItemText(5, _translate("MainWindow", "Above Lower"))
        self.bDirectionComboBox.setItemText(6, _translate("MainWindow", "Below Lower"))
        self.bDirectionComboBox.setItemText(7, _translate("MainWindow", "Rising Lower"))
        self.bDirectionComboBox.setItemText(8, _translate("MainWindow", "Falling Lower"))
        self.bDirectionComboBox.setItemText(9, _translate("MainWindow", "Positive Runt"))
        self.bDirectionComboBox.setItemText(10, _translate("MainWindow", "Negative Runt"))
        self.extDirectionComboBox.setItemText(0, _translate("MainWindow", "Above"))
        self.extDirectionComboBox.setItemText(1, _translate("MainWindow", "Below"))
        self.extDirectionComboBox.setItemText(2, _translate("MainWindow", "Rising"))
        self.extDirectionComboBox.setItemText(3, _translate("MainWindow", "Falling"))
        self.extDirectionComboBox.setItemText(4, _translate("MainWindow", "Rising or Falling"))
        self.extDirectionComboBox.setItemText(5, _translate("MainWindow", "Above Lower"))
        self.extDirectionComboBox.setItemText(6, _translate("MainWindow", "Below Lower"))
        self.extDirectionComboBox.setItemText(7, _translate("MainWindow", "Rising Lower"))
        self.extDirectionComboBox.setItemText(8, _translate("MainWindow", "Falling Lower"))
        self.extDirectionComboBox.setItemText(9, _translate("MainWindow", "Positive Runt"))
        self.extDirectionComboBox.setItemText(10, _translate("MainWindow", "Negative Runt"))
        self.dDirectionComboBox.setItemText(0, _translate("MainWindow", "Above"))
        self.dDirectionComboBox.setItemText(1, _translate("MainWindow", "Below"))
        self.dDirectionComboBox.setItemText(2, _translate("MainWindow", "Rising"))
        self.dDirectionComboBox.setItemText(3, _translate("MainWindow", "Falling"))
        self.dDirectionComboBox.setItemText(4, _translate("MainWindow", "Rising or Falling"))
        self.dDirectionComboBox.setItemText(5, _translate("MainWindow", "Above Lower"))
        self.dDirectionComboBox.setItemText(6, _translate("MainWindow", "Below Lower"))
        self.dDirectionComboBox.setItemText(7, _translate("MainWindow", "Rising Lower"))
        self.dDirectionComboBox.setItemText(8, _translate("MainWindow", "Falling Lower"))
        self.dDirectionComboBox.setItemText(9, _translate("MainWindow", "Positive Runt"))
        self.dDirectionComboBox.setItemText(10, _translate("MainWindow", "Negative Runt"))
        self.thresholdModeLabel.setText(_translate("MainWindow", "Mode"))
        self.cDirectionComboBox.setItemText(0, _translate("MainWindow", "Above"))
        self.cDirectionComboBox.setItemText(1, _translate("MainWindow", "Below"))
        self.cDirectionComboBox.setItemText(2, _translate("MainWindow", "Rising"))
        self.cDirectionComboBox.setItemText(3, _translate("MainWindow", "Falling"))
        self.cDirectionComboBox.setItemText(4, _translate("MainWindow", "Rising or Falling"))
        self.cDirectionComboBox.setItemText(5, _translate("MainWindow", "Above Lower"))
        self.cDirectionComboBox.setItemText(6, _translate("MainWindow", "Below Lower"))
        self.cDirectionComboBox.setItemText(7, _translate("MainWindow", "Rising Lower"))
        self.cDirectionComboBox.setItemText(8, _translate("MainWindow", "Falling Lower"))
        self.cDirectionComboBox.setItemText(9, _translate("MainWindow", "Positive Runt"))
        self.cDirectionComboBox.setItemText(10, _translate("MainWindow", "Negative Runt"))
        self.aDirectionComboBox.setItemText(0, _translate("MainWindow", "Above"))
        self.aDirectionComboBox.setItemText(1, _translate("MainWindow", "Below"))
        self.aDirectionComboBox.setItemText(2, _translate("MainWindow", "Rising"))
        self.aDirectionComboBox.setItemText(3, _translate("MainWindow", "Falling"))
        self.aDirectionComboBox.setItemText(4, _translate("MainWindow", "Rising or Falling"))
        self.aDirectionComboBox.setItemText(5, _translate("MainWindow", "Above Lower"))
        self.aDirectionComboBox.setItemText(6, _translate("MainWindow", "Below Lower"))
        self.aDirectionComboBox.setItemText(7, _translate("MainWindow", "Rising Lower"))
        self.aDirectionComboBox.setItemText(8, _translate("MainWindow", "Falling Lower"))
        self.aDirectionComboBox.setItemText(9, _translate("MainWindow", "Positive Runt"))
        self.aDirectionComboBox.setItemText(10, _translate("MainWindow", "Negative Runt"))
        self.dThresholdModeComboBox.setItemText(0, _translate("MainWindow", "Level"))
        self.dThresholdModeComboBox.setItemText(1, _translate("MainWindow", "Window"))
        self.bThresholdModeComboBox.setItemText(0, _translate("MainWindow", "Level"))
        self.bThresholdModeComboBox.setItemText(1, _translate("MainWindow", "Window"))
        self.extThresholdModeComboBox.setItemText(0, _translate("MainWindow", "Level"))
        self.extThresholdModeComboBox.setItemText(1, _translate("MainWindow", "Window"))
        self.cThresholdModeComboBox.setItemText(0, _translate("MainWindow", "Level"))
        self.cThresholdModeComboBox.setItemText(1, _translate("MainWindow", "Window"))
        self.runButton.setText(_translate("MainWindow", "Run"))
        self.runsLabel.setText(_translate("MainWindow", "Runs"))
        self.tabWidget.setTabText(self.tabWidget.indexOf(runList['runTab'][-1]), _translate("MainWindow", "Run 1"))
        self.menuPreset.setTitle(_translate("MainWindow", "Presets"))
        self.actionLoad_Preset.setText(_translate("MainWindow", "Load Preset"))
        self.actionLoad_Preset.setShortcut(_translate("MainWindow", "Ctrl+O"))
        self.actionSave_Preset.setText(_translate("MainWindow", "Save Preset"))
        self.actionSave_Preset.setShortcut(_translate("MainWindow", "Ctrl+S"))

        #Defaults
        self.outFileNameLineEdit.setEnabled(False)

        self.cCheck.setEnabled(False)
        self.dCheck.setEnabled(False)
        self.cRangeComboBox.setEnabled(False)
        self.dRangeComboBox.setEnabled(False)
        self.cOffsetSpinBox.setEnabled(False)
        self.dOffsetSpinBox.setEnabled(False)
        self.cCouplingComboBox.setEnabled(False)
        self.dCouplingComboBox.setEnabled(False)
        self.cTriggerCheck.setEnabled(False)
        self.dTriggerCheck.setEnabled(False)
        self.extTriggerCheck.setEnabled(False)
        self.cUpperThresholdSpinBox.setEnabled(False)
        self.dUpperThresholdSpinBox.setEnabled(False)
        self.extUpperThresholdSpinBox.setEnabled(False)
        self.cUpperHysteresisSpinBox.setEnabled(False)
        self.dUpperHysteresisSpinBox.setEnabled(False)
        self.extUpperHysteresisSpinBox.setEnabled(False)
        self.cLowerThresholdSpinBox.setEnabled(False)
        self.dLowerThresholdSpinBox.setEnabled(False)
        self.extLowerThresholdSpinBox.setEnabled(False)
        self.cLowerHysteresisSpinBox.setEnabled(False)
        self.dLowerHysteresisSpinBox.setEnabled(False)
        self.extLowerHysteresisSpinBox.setEnabled(False)
        conditionList['cStateComboBox'][-1].setEnabled(False)
        conditionList['dStateComboBox'][-1].setEnabled(False)
        conditionList['extStateComboBox'][-1].setEnabled(False)
        self.cDirectionComboBox.setEnabled(False)
        self.dDirectionComboBox.setEnabled(False)
        self.extDirectionComboBox.setEnabled(False)
        self.cThresholdModeComboBox.setEnabled(False)
        self.dThresholdModeComboBox.setEnabled(False)
        self.extThresholdModeComboBox.setEnabled(False)

        self.totalRuntimeSpinBox.setEnabled(False)
        self.timeUnitsComboBox.setEnabled(False)
        self.segmentsSpinBox.setEnabled(False)
        self.capturesSpinBox.setEnabled(False)
        self.samplesPerBufferSpinBox.setEnabled(False)

        self.aUpperHysteresisSpinBox.setEnabled(False)
        self.bUpperHysteresisSpinBox.setEnabled(False)
        self.cUpperHysteresisSpinBox.setEnabled(False)
        self.dUpperHysteresisSpinBox.setEnabled(False)
        self.aLowerThresholdSpinBox.setEnabled(False)
        self.bLowerThresholdSpinBox.setEnabled(False)
        self.cLowerThresholdSpinBox.setEnabled(False)
        self.dLowerThresholdSpinBox.setEnabled(False)
        self.aLowerHysteresisSpinBox.setEnabled(False)
        self.bLowerHysteresisSpinBox.setEnabled(False)
        self.cLowerHysteresisSpinBox.setEnabled(False)
        self.dLowerHysteresisSpinBox.setEnabled(False)
        self.aThresholdModeComboBox.setEnabled(False)
        self.bThresholdModeComboBox.setEnabled(False)
        self.cThresholdModeComboBox.setEnabled(False)
        self.dThresholdModeComboBox.setEnabled(False)
        conditionList['aStateComboBox'][-1].setEnabled(False)
        conditionList['bStateComboBox'][-1].setEnabled(False)
        self.newConditionButton.setEnabled(False)
        self.deleteConditionButton.setEnabled(False)

        self.aRangeComboBox.model().item(0).setEnabled(False)
        self.aRangeComboBox.model().item(11).setEnabled(False)
        self.bRangeComboBox.model().item(0).setEnabled(False)
        self.bRangeComboBox.model().item(11).setEnabled(False)
        self.aRangeComboBox.setCurrentIndex(1)
        self.bRangeComboBox.setCurrentIndex(1)
        self.timeUnitsComboBox.setCurrentText('ns')

        self.runsSpinBox.setMinimum(1)
        self.timebaseSpinBox.setMinimum(1)
        self.segmentsSpinBox.setMinimum(1)
        self.capturesSpinBox.setMinimum(1)
        self.totalRuntimeSpinBox.setMinimum(1)
        self.preTriggerSamplesSpinBox.setMinimum(0)
        self.postTriggerSamplesSpinBox.setMinimum(0)
        self.samplesPerBufferSpinBox.setMinimum(1)
        self.aUpperThresholdSpinBox.setMinimum(-32512)
        self.aUpperHysteresisSpinBox.setMinimum(-32512)
        self.aLowerThresholdSpinBox.setMinimum(-32512)
        self.aLowerHysteresisSpinBox.setMinimum(-32512)
        self.bUpperThresholdSpinBox.setMinimum(-32512)
        self.bUpperHysteresisSpinBox.setMinimum(-32512)
        self.bLowerThresholdSpinBox.setMinimum(-32512)
        self.bLowerHysteresisSpinBox.setMinimum(-32512)
        self.cUpperThresholdSpinBox.setMinimum(-32512)
        self.cUpperHysteresisSpinBox.setMinimum(-32512)
        self.cLowerThresholdSpinBox.setMinimum(-32512)
        self.cLowerHysteresisSpinBox.setMinimum(-32512)
        self.dUpperThresholdSpinBox.setMinimum(-32512)
        self.dUpperHysteresisSpinBox.setMinimum(-32512)
        self.dLowerThresholdSpinBox.setMinimum(-32512)
        self.dLowerHysteresisSpinBox.setMinimum(-32512)
        self.extUpperThresholdSpinBox.setMinimum(-32767)
        self.extUpperHysteresisSpinBox.setMinimum(-32767)
        self.extLowerThresholdSpinBox.setMinimum(-32767)
        self.extLowerHysteresisSpinBox.setMinimum(-32767)

        self.pageNumLineEdit.setText('1')
        self.pageNumLineEdit.setAlignment(QtCore.Qt.AlignCenter)
        self.nextPushButton.setText(_translate("MainWindow", "Next"))
        self.nextPushButton.setEnabled(False)
        self.previousPushButton.setText(_translate("MainWindow", "Previous"))
        self.previousPushButton.setEnabled(False)

        self.graphCheck.setText(_translate("MainWindow", "Graphing"))
        self.graphCheck.setChecked(True)

        f = open('driver.log', 'r')
        self.driverLineEdit.setText(f.readline().replace('\n', ''))
        f.close()
        self.driverChannelCheck()

        dir = os.path.join('.', 'presets')
        if not os.path.exists(dir):
            os.mkdir(dir)
        presetList = os.listdir('./presets')
        for i in range(len(presetList)):
            if presetList[i].split('.')[1] =='prst':
                f = open('./presets/'+presetList[i], 'r')
                driver = f.readline().replace('\n', '')
                if self.driverLineEdit.text() != driver:
                    continue
                f.close()
                self.presetComboBox.addItem(presetList[i].split('.')[0])

        #Actions
        self.outFileCheckBox.clicked.connect(self.fileOutCheck)
        self.modeComboBox.currentTextChanged.connect(self.captureModeCheck)
        self.triggerTypeComboBox.currentTextChanged.connect(self.triggerTypeCheck)
        self.newConditionButton.clicked.connect(self.newCondition)
        self.deleteConditionButton.clicked.connect(self.deleteCondition)
        self.actionSave_Preset.triggered.connect(self.savePreset)
        self.actionLoad_Preset.triggered.connect(self.loadPreset)
        self.presetComboBox.currentTextChanged.connect(self.loadDetectedPreset)
        self.runButton.clicked.connect(self.run)
        self.aTriggerCheck.clicked.connect(self.simpleTriggerCheck)
        self.bTriggerCheck.clicked.connect(self.simpleTriggerCheck)
        self.cTriggerCheck.clicked.connect(self.simpleTriggerCheck)
        self.dTriggerCheck.clicked.connect(self.simpleTriggerCheck)
        self.extTriggerCheck.clicked.connect(self.simpleTriggerCheck)
        self.nextPushButton.clicked.connect(self.nextPage)
        self.pageNumLineEdit.textChanged.connect(self.pageChangeCheck)
        self.previousPushButton.clicked.connect(self.previousPage)
        self.tabWidget.currentChanged.connect(self.runTabChange)
        self.graphCheck.clicked.connect(self.graphing)

    def graphing(self):
        self.tabWidget.setEnabled(int(self.graphCheck.checkState()))

    def nextPage(self):
        self.pageNumLineEdit.setText(str(int(self.pageNumLineEdit.text())+1))

    def previousPage(self):
        self.pageNumLineEdit.setText(str(int(self.pageNumLineEdit.text())-1))

    def pageChangeCheck(self):
        try:
            self.pageNumLineEdit.setText(str(int(float(self.pageNumLineEdit.text()))))
            if int(float(self.pageNumLineEdit.text())) > len(runList['captureTab'][self.tabWidget.currentIndex()]):
                self.pageNumLineEdit.setText(str(len(runList['captureTab'][self.tabWidget.currentIndex()])))
            elif int(float(self.pageNumLineEdit.text())) < 1:
                self.pageNumLineEdit.setText('1')
            if int(float(self.pageNumLineEdit.text())) == len(runList['captureTab'][self.tabWidget.currentIndex()]):
                self.nextPushButton.setEnabled(False)
            else:
                self.nextPushButton.setEnabled(True)
            if int(float(self.pageNumLineEdit.text())) == 1:
                self.previousPushButton.setEnabled(False)
            else:
                self.previousPushButton.setEnabled(True)
            runList['stackedWidget'][self.tabWidget.currentIndex()].setCurrentIndex(int(float(self.pageNumLineEdit.text()))-1)
        except:
            pass

    def runTabChange(self):
        self.pageNumLineEdit.setText(str(runList['stackedWidget'][self.tabWidget.currentIndex()].currentIndex()+1))

    def fileOutCheck(self):
        if self.outFileCheckBox.isChecked():
            self.outFileNameLineEdit.setEnabled(True)
        else:
            self.outFileNameLineEdit.setText('')
            self.outFileNameLineEdit.setEnabled(False)

    def driverChannelCheck(self):
        driver_replacement(self.driverLineEdit.text())
        if str(self.driverLineEdit.text()) == 'ps2000a':
            self.cCheck.setEnabled(False)
            self.cCheck.setChecked(False)
            self.dCheck.setEnabled(False)
            self.dCheck.setChecked(False)
            self.cRangeComboBox.setEnabled(False)
            self.dRangeComboBox.setEnabled(False)
            self.cOffsetSpinBox.setEnabled(False)
            self.dOffsetSpinBox.setEnabled(False)
            self.cCouplingComboBox.setEnabled(False)
            self.dCouplingComboBox.setEnabled(False)
            self.aTriggerCheck.setEnabled(True)
            self.bTriggerCheck.setEnabled(True)
            self.cTriggerCheck.setEnabled(False)
            self.cTriggerCheck.setChecked(False)
            self.dTriggerCheck.setEnabled(False)
            self.dTriggerCheck.setChecked(False)
            self.extTriggerCheck.setEnabled(False)
            self.extTriggerCheck.setChecked(False)
            self.aUpperThresholdSpinBox.setEnabled(True)
            self.bUpperThresholdSpinBox.setEnabled(True)
            self.cUpperThresholdSpinBox.setEnabled(False)
            self.dUpperThresholdSpinBox.setEnabled(False)
            self.extUpperThresholdSpinBox.setEnabled(False)
            self.cUpperHysteresisSpinBox.setEnabled(False)
            self.dUpperHysteresisSpinBox.setEnabled(False)
            self.extUpperHysteresisSpinBox.setEnabled(False)
            self.cLowerThresholdSpinBox.setEnabled(False)
            self.dLowerThresholdSpinBox.setEnabled(False)
            self.extLowerThresholdSpinBox.setEnabled(False)
            self.cLowerHysteresisSpinBox.setEnabled(False)
            self.dLowerHysteresisSpinBox.setEnabled(False)
            self.extLowerHysteresisSpinBox.setEnabled(False)
            for i in range(len(conditionList['aStateComboBox'])):
                conditionList['cStateComboBox'][i].setEnabled(False)
                conditionList['dStateComboBox'][i].setEnabled(False)
                conditionList['extStateComboBox'][i].setEnabled(False)
            self.aDirectionComboBox.setEnabled(True)
            self.bDirectionComboBox.setEnabled(True)
            self.cDirectionComboBox.setEnabled(False)
            self.dDirectionComboBox.setEnabled(False)
            self.extDirectionComboBox.setEnabled(False)
            self.cThresholdModeComboBox.setEnabled(False)
            self.dThresholdModeComboBox.setEnabled(False)
            self.extThresholdModeComboBox.setEnabled(False)
            self.aRangeComboBox.model().item(0).setEnabled(False)
            self.aRangeComboBox.model().item(11).setEnabled(False)
            self.bRangeComboBox.model().item(0).setEnabled(False)
            self.bRangeComboBox.model().item(11).setEnabled(False)
        elif str(self.driverLineEdit.text()) == 'ps3000a':
            self.cCheck.setEnabled(True)
            self.dCheck.setEnabled(True)
            self.cRangeComboBox.setEnabled(True)
            self.dRangeComboBox.setEnabled(True)
            self.cOffsetSpinBox.setEnabled(True)
            self.dOffsetSpinBox.setEnabled(True)
            self.cCouplingComboBox.setEnabled(True)
            self.dCouplingComboBox.setEnabled(True)
            self.aRangeComboBox.model().item(0).setEnabled(True)
            self.aRangeComboBox.model().item(11).setEnabled(True)
            self.bRangeComboBox.model().item(0).setEnabled(True)
            self.bRangeComboBox.model().item(11).setEnabled(True)
            if (str(self.triggerTypeComboBox.currentText()) == 'Simple' and not (self.aTriggerCheck.isChecked() or self.bTriggerCheck.isChecked())) or str(self.triggerTypeComboBox.currentText()) == 'Complex':
                self.cTriggerCheck.setEnabled(True)
                self.dTriggerCheck.setEnabled(True)
                self.extTriggerCheck.setEnabled(True)
                self.cUpperThresholdSpinBox.setEnabled(True)
                self.dUpperThresholdSpinBox.setEnabled(True)
                self.extUpperThresholdSpinBox.setEnabled(True)
                self.cDirectionComboBox.setEnabled(True)
                self.dDirectionComboBox.setEnabled(True)
                self.extDirectionComboBox.setEnabled(True)
            if str(self.triggerTypeComboBox.currentText()) == 'Complex':
                self.cUpperHysteresisSpinBox.setEnabled(True)
                self.dUpperHysteresisSpinBox.setEnabled(True)
                self.extUpperHysteresisSpinBox.setEnabled(True)
                self.cLowerThresholdSpinBox.setEnabled(True)
                self.dLowerThresholdSpinBox.setEnabled(True)
                self.extLowerThresholdSpinBox.setEnabled(True)
                self.cLowerHysteresisSpinBox.setEnabled(True)
                self.dLowerHysteresisSpinBox.setEnabled(True)
                self.extLowerHysteresisSpinBox.setEnabled(True)
                for i in range(len(conditionList['aStateComboBox'])):
                    conditionList['cStateComboBox'][i].setEnabled(True)
                    conditionList['dStateComboBox'][i].setEnabled(True)
                    conditionList['extStateComboBox'][i].setEnabled(True)
                self.cThresholdModeComboBox.setEnabled(True)
                self.dThresholdModeComboBox.setEnabled(True)
                self.extThresholdModeComboBox.setEnabled(True)

    def captureModeCheck(self):
        if str(self.modeComboBox.currentText()) == 'Block':
            self.timebaseSpinBox.setEnabled(True)
            self.totalRuntimeSpinBox.setEnabled(False)
            self.totalRuntimeSpinBox.setValue(1)
            self.timeUnitsComboBox.setEnabled(False)
            self.timeUnitsComboBox.setCurrentText('ns')
            self.capturesSpinBox.setEnabled(False)
            self.capturesSpinBox.setValue(1)
            self.samplesPerBufferSpinBox.setEnabled(False)
            self.samplesPerBufferSpinBox.setValue(1)
            self.segmentsSpinBox.setEnabled(False)
            self.segmentsSpinBox.setValue(1)
        elif str(self.modeComboBox.currentText()) == 'Rapid Block':
            self.timebaseSpinBox.setEnabled(True)
            self.totalRuntimeSpinBox.setEnabled(False)
            self.totalRuntimeSpinBox.setValue(1)
            self.timeUnitsComboBox.setEnabled(False)
            self.timeUnitsComboBox.setCurrentText('ns')
            self.capturesSpinBox.setEnabled(True)
            self.samplesPerBufferSpinBox.setEnabled(False)
            self.samplesPerBufferSpinBox.setValue(1)
            self.segmentsSpinBox.setEnabled(True)
        elif str(self.modeComboBox.currentText()) == 'Streaming':
            self.timebaseSpinBox.setEnabled(False)
            self.timebaseSpinBox.setValue(1)
            self.totalRuntimeSpinBox.setEnabled(True)
            self.timeUnitsComboBox.setEnabled(True)
            self.capturesSpinBox.setEnabled(False)
            self.capturesSpinBox.setValue(1)
            self.samplesPerBufferSpinBox.setEnabled(True)
            self.segmentsSpinBox.setEnabled(True)

    def triggerTypeCheck(self):
        if str(self.triggerTypeComboBox.currentText()) == 'Simple':
            self.simpleTriggerCheck()
            checkCount = 0
            if bool(int(self.aTriggerCheck.checkState())) and str(self.driverLineEdit.text()) == 'ps2000a':
                checkCount += 1
                self.aTriggerCheck.setEnabled(True)
                self.aUpperThresholdSpinBox.setEnabled(True)
                self.aDirectionComboBox.setEnabled(True)
            if bool(int(self.bTriggerCheck.checkState())) and str(self.driverLineEdit.text()) == 'ps2000a':
                checkCount += 1
                self.bTriggerCheck.setEnabled(True)
                self.bUpperThresholdSpinBox.setEnabled(True)
                self.bDirectionComboBox.setEnabled(True)
            if bool(int(self.cTriggerCheck.checkState())) and str(self.driverLineEdit.text()) == 'ps3000a':
                checkCount += 1
                self.cTriggerCheck.setEnabled(True)
                self.cUpperThresholdSpinBox.setEnabled(True)
                self.cDirectionComboBox.setEnabled(True)
            if bool(int(self.dTriggerCheck.checkState())) and str(self.driverLineEdit.text()) == 'ps3000a':
                checkCount += 1
                self.dTriggerCheck.setEnabled(True)
                self.dUpperThresholdSpinBox.setEnabled(True)
                self.dDirectionComboBox.setEnabled(True)
            if bool(int(self.extTriggerCheck.checkState())) and str(self.driverLineEdit.text()) == 'ps3000a':
                checkCount += 1
                self.extTriggerCheck.setEnabled(True)
                self.extUpperThresholdSpinBox.setEnabled(True)
                self.extDirectionComboBox.setEnabled(True)
            if checkCount > 1:
                self.aTriggerCheck.setChecked(False)
                self.bTriggerCheck.setChecked(False)
                self.cTriggerCheck.setChecked(False)
                self.dTriggerCheck.setChecked(False)
                self.extTriggerCheck.setChecked(False)
            self.aUpperHysteresisSpinBox.setEnabled(False)
            self.bUpperHysteresisSpinBox.setEnabled(False)
            self.cUpperHysteresisSpinBox.setEnabled(False)
            self.dUpperHysteresisSpinBox.setEnabled(False)
            self.extUpperHysteresisSpinBox.setEnabled(False)
            self.aLowerThresholdSpinBox.setEnabled(False)
            self.bLowerThresholdSpinBox.setEnabled(False)
            self.cLowerThresholdSpinBox.setEnabled(False)
            self.dLowerThresholdSpinBox.setEnabled(False)
            self.extLowerThresholdSpinBox.setEnabled(False)
            self.aLowerHysteresisSpinBox.setEnabled(False)
            self.bLowerHysteresisSpinBox.setEnabled(False)
            self.cLowerHysteresisSpinBox.setEnabled(False)
            self.dLowerHysteresisSpinBox.setEnabled(False)
            self.extLowerHysteresisSpinBox.setEnabled(False)
            self.aThresholdModeComboBox.setEnabled(False)
            self.bThresholdModeComboBox.setEnabled(False)
            self.cThresholdModeComboBox.setEnabled(False)
            self.dThresholdModeComboBox.setEnabled(False)
            self.extThresholdModeComboBox.setEnabled(False)
            for i in range(len(conditionList['aStateComboBox'])):
                conditionList['aStateComboBox'][i].setEnabled(False)
                conditionList['bStateComboBox'][i].setEnabled(False)
                conditionList['cStateComboBox'][i].setEnabled(False)
                conditionList['dStateComboBox'][i].setEnabled(False)
                conditionList['extStateComboBox'][i].setEnabled(False)
            self.newConditionButton.setEnabled(False)
            self.deleteConditionButton.setEnabled(False)
        elif str(self.triggerTypeComboBox.currentText()) == 'Complex':
            self.aTriggerCheck.setEnabled(True)
            self.bTriggerCheck.setEnabled(True)
            self.aUpperThresholdSpinBox.setEnabled(True)
            self.bUpperThresholdSpinBox.setEnabled(True)
            self.aUpperHysteresisSpinBox.setEnabled(True)
            self.bUpperHysteresisSpinBox.setEnabled(True)
            self.aLowerThresholdSpinBox.setEnabled(True)
            self.bLowerThresholdSpinBox.setEnabled(True)
            self.aLowerHysteresisSpinBox.setEnabled(True)
            self.bLowerHysteresisSpinBox.setEnabled(True)
            self.aThresholdModeComboBox.setEnabled(True)
            self.bThresholdModeComboBox.setEnabled(True)
            self.aDirectionComboBox.setEnabled(True)
            self.bDirectionComboBox.setEnabled(True)
            for i in range(len(conditionList['aStateComboBox'])):
                conditionList['aStateComboBox'][i].setEnabled(True)
                conditionList['bStateComboBox'][i].setEnabled(True)
            self.newConditionButton.setEnabled(True)
            self.deleteConditionButton.setEnabled(True)
            if str(self.driverLineEdit.text()) == 'ps3000a':
                self.cTriggerCheck.setEnabled(True)
                self.dTriggerCheck.setEnabled(True)
                self.extTriggerCheck.setEnabled(True)
                self.cUpperThresholdSpinBox.setEnabled(True)
                self.dUpperThresholdSpinBox.setEnabled(True)
                self.extUpperThresholdSpinBox.setEnabled(True)
                self.cUpperHysteresisSpinBox.setEnabled(True)
                self.dUpperHysteresisSpinBox.setEnabled(True)
                self.extUpperHysteresisSpinBox.setEnabled(True)
                self.cLowerThresholdSpinBox.setEnabled(True)
                self.dLowerThresholdSpinBox.setEnabled(True)
                self.extLowerThresholdSpinBox.setEnabled(True)
                self.cLowerHysteresisSpinBox.setEnabled(True)
                self.dLowerHysteresisSpinBox.setEnabled(True)
                self.extLowerHysteresisSpinBox.setEnabled(True)
                self.cThresholdModeComboBox.setEnabled(True)
                self.dThresholdModeComboBox.setEnabled(True)
                self.extThresholdModeComboBox.setEnabled(True)
                self.cDirectionComboBox.setEnabled(True)
                self.dDirectionComboBox.setEnabled(True)
                self.extDirectionComboBox.setEnabled(True)
                for i in range(len(conditionList['aStateComboBox'])):
                    conditionList['cStateComboBox'][i].setEnabled(True)
                    conditionList['dStateComboBox'][i].setEnabled(True)
                    conditionList['extStateComboBox'][i].setEnabled(True)

    def newCondition(self):
        _translate = QtCore.QCoreApplication.translate
        conditionList['conditionTab'].append(QtWidgets.QWidget())
        conditionList['conditionTab'][-1].setObjectName("condition"+str(len(conditionList['conditionTab']))+"Tab")
        conditionList['extConditionLabel'].append(QtWidgets.QLabel(conditionList['conditionTab'][-1]))
        conditionList['extConditionLabel'][-1].setGeometry(QtCore.QRect(10*widthRatio, 100*heightRatio, 16*widthRatio, 16*heightRatio))
        conditionList['extConditionLabel'][-1].setObjectName("extConditionLabel")
        conditionList['aConditionLabel'].append(QtWidgets.QLabel(conditionList['conditionTab'][-1]))
        conditionList['aConditionLabel'][-1].setGeometry(QtCore.QRect(10*widthRatio, 20*heightRatio, 16*widthRatio, 16*heightRatio))
        conditionList['aConditionLabel'][-1].setObjectName("aConditionLabel")
        conditionList['bConditionLabel'].append(QtWidgets.QLabel(conditionList['conditionTab'][-1]))
        conditionList['bConditionLabel'][-1].setGeometry(QtCore.QRect(10*widthRatio, 40*heightRatio, 16*widthRatio, 16*heightRatio))
        conditionList['bConditionLabel'][-1].setObjectName("bConditionLabel")
        conditionList['cConditionLabel'].append(QtWidgets.QLabel(conditionList['conditionTab'][-1]))
        conditionList['cConditionLabel'][-1].setGeometry(QtCore.QRect(10*widthRatio, 60*heightRatio, 16*widthRatio, 16*heightRatio))
        conditionList['cConditionLabel'][-1].setObjectName("cConditionLabel")
        conditionList['dConditionLabel'].append(QtWidgets.QLabel(conditionList['conditionTab'][-1]))
        conditionList['dConditionLabel'][-1].setGeometry(QtCore.QRect(10*widthRatio, 80*heightRatio, 16*widthRatio, 16*heightRatio))
        conditionList['dConditionLabel'][-1].setObjectName("dConditionLabel")
        conditionList['aStateComboBox'].append(QtWidgets.QComboBox(conditionList['conditionTab'][-1]))
        conditionList['aStateComboBox'][-1].setGeometry(QtCore.QRect(30*widthRatio, 20*heightRatio, 81*widthRatio, 16*heightRatio))
        conditionList['aStateComboBox'][-1].setObjectName("aStateComboBox")
        conditionList['aStateComboBox'][-1].addItem("")
        conditionList['aStateComboBox'][-1].addItem("")
        conditionList['aStateComboBox'][-1].addItem("")
        conditionList['bStateComboBox'].append(QtWidgets.QComboBox(conditionList['conditionTab'][-1]))
        conditionList['bStateComboBox'][-1].setGeometry(QtCore.QRect(30*widthRatio, 40*heightRatio, 81*widthRatio, 16*heightRatio))
        conditionList['bStateComboBox'][-1].setObjectName("bStateComboBox")
        conditionList['bStateComboBox'][-1].addItem("")
        conditionList['bStateComboBox'][-1].addItem("")
        conditionList['bStateComboBox'][-1].addItem("")
        conditionList['cStateComboBox'].append(QtWidgets.QComboBox(conditionList['conditionTab'][-1]))
        conditionList['cStateComboBox'][-1].setGeometry(QtCore.QRect(30*widthRatio, 60*heightRatio, 81*widthRatio, 16*heightRatio))
        conditionList['cStateComboBox'][-1].setObjectName("cStateComboBox")
        conditionList['cStateComboBox'][-1].addItem("")
        conditionList['cStateComboBox'][-1].addItem("")
        conditionList['cStateComboBox'][-1].addItem("")
        conditionList['dStateComboBox'].append(QtWidgets.QComboBox(conditionList['conditionTab'][-1]))
        conditionList['dStateComboBox'][-1].setGeometry(QtCore.QRect(30*widthRatio, 80*heightRatio, 81*widthRatio, 16*heightRatio))
        conditionList['dStateComboBox'][-1].setObjectName("dStateComboBox")
        conditionList['dStateComboBox'][-1].addItem("")
        conditionList['dStateComboBox'][-1].addItem("")
        conditionList['dStateComboBox'][-1].addItem("")
        conditionList['extStateComboBox'].append(QtWidgets.QComboBox(conditionList['conditionTab'][-1]))
        conditionList['extStateComboBox'][-1].setGeometry(QtCore.QRect(30*widthRatio, 100*heightRatio, 81*widthRatio, 16*heightRatio))
        conditionList['extStateComboBox'][-1].setObjectName("extStateComboBox")
        conditionList['extStateComboBox'][-1].addItem("")
        conditionList['extStateComboBox'][-1].addItem("")
        conditionList['extStateComboBox'][-1].addItem("")
        conditionList['stateLabel'].append(QtWidgets.QLabel(conditionList['conditionTab'][-1]))
        conditionList['stateLabel'][-1].setGeometry(QtCore.QRect(30*widthRatio, 0*heightRatio, 81*widthRatio, 16*heightRatio))
        conditionList['stateLabel'][-1].setObjectName("stateLabel")
        self.conditionsTabWidget.addTab(conditionList['conditionTab'][-1], "")
        conditionList['extConditionLabel'][-1].setText(_translate("MainWindow", "Ext"))
        conditionList['aConditionLabel'][-1].setText(_translate("MainWindow", "A"))
        conditionList['bConditionLabel'][-1].setText(_translate("MainWindow", "B"))
        conditionList['cConditionLabel'][-1].setText(_translate("MainWindow", "C"))
        conditionList['dConditionLabel'][-1].setText(_translate("MainWindow", "D"))
        conditionList['aStateComboBox'][-1].setItemText(0, _translate("MainWindow", "Don\'t Care"))
        conditionList['aStateComboBox'][-1].setItemText(1, _translate("MainWindow", "True"))
        conditionList['aStateComboBox'][-1].setItemText(2, _translate("MainWindow", "False"))
        conditionList['bStateComboBox'][-1].setItemText(0, _translate("MainWindow", "Don\'t Care"))
        conditionList['bStateComboBox'][-1].setItemText(1, _translate("MainWindow", "True"))
        conditionList['bStateComboBox'][-1].setItemText(2, _translate("MainWindow", "False"))
        conditionList['cStateComboBox'][-1].setItemText(0, _translate("MainWindow", "Don\'t Care"))
        conditionList['cStateComboBox'][-1].setItemText(1, _translate("MainWindow", "True"))
        conditionList['cStateComboBox'][-1].setItemText(2, _translate("MainWindow", "False"))
        conditionList['dStateComboBox'][-1].setItemText(0, _translate("MainWindow", "Don\'t Care"))
        conditionList['dStateComboBox'][-1].setItemText(1, _translate("MainWindow", "True"))
        conditionList['dStateComboBox'][-1].setItemText(2, _translate("MainWindow", "False"))
        conditionList['extStateComboBox'][-1].setItemText(0, _translate("MainWindow", "Don\'t Care"))
        conditionList['extStateComboBox'][-1].setItemText(1, _translate("MainWindow", "True"))
        conditionList['extStateComboBox'][-1].setItemText(2, _translate("MainWindow", "False"))
        conditionList['stateLabel'][-1].setText(_translate("MainWindow", "State Condition"))
        self.conditionsTabWidget.setTabText(self.conditionsTabWidget.indexOf(conditionList['conditionTab'][-1]), _translate("MainWindow", str(len(conditionList['conditionTab']))))
        conditionList['aStateComboBox'][-1].setEnabled(False)
        conditionList['bStateComboBox'][-1].setEnabled(False)
        conditionList['cStateComboBox'][-1].setEnabled(False)
        conditionList['dStateComboBox'][-1].setEnabled(False)
        conditionList['extStateComboBox'][-1].setEnabled(False)
        self.triggerTypeCheck()

    def deleteCondition(self):
        _translate = QtCore.QCoreApplication.translate
        indx = self.conditionsTabWidget.currentIndex()
        self.conditionsTabWidget.removeTab(indx)
        if len(conditionList['aStateComboBox']) == 0:
            return 0
        for name in conditionList:
            conditionList[name].pop(indx)
        for i in range(indx, len(conditionList['aStateComboBox'])):
            self.conditionsTabWidget.setTabText(self.conditionsTabWidget.indexOf(conditionList['conditionTab'][i]), _translate("MainWindow", str(i+1)))

    def savePreset(self):
        _translate = QtCore.QCoreApplication.translate
        if self.presetComboBox.currentText() == 'Manual':
            presetFileName, ok = QtWidgets.QInputDialog().getText(MainWindow, 'New Preset', 'New Preset File Name:', QtWidgets.QLineEdit.Normal, QtCore.QDir().home().dirName())
        else:
            presetFileName = self.presetComboBox.currentText()
        if presetFileName == '':
            return 0
        f = open('presets/'+presetFileName+'.prst', 'w')
        f.write(self.driverLineEdit.text()+'\n')
        f.write(str(self.outFileCheckBox.checkState())+'\n')
        f.write(self.outFileNameLineEdit.text()+'\n')
        f.write(self.runsSpinBox.text()+'\n')
        f.write(str(self.aCheck.checkState())+'\n')
        f.write(str(self.bCheck.checkState())+'\n')
        f.write(str(self.cCheck.checkState())+'\n')
        f.write(str(self.dCheck.checkState())+'\n')
        f.write(self.aRangeComboBox.currentText()+'\n')
        f.write(self.bRangeComboBox.currentText()+'\n')
        f.write(self.cRangeComboBox.currentText()+'\n')
        f.write(self.dRangeComboBox.currentText()+'\n')
        f.write(self.aOffsetSpinBox.text()+'\n')
        f.write(self.bOffsetSpinBox.text()+'\n')
        f.write(self.cOffsetSpinBox.text()+'\n')
        f.write(self.dOffsetSpinBox.text()+'\n')
        f.write(self.modeComboBox.currentText()+'\n')
        f.write(self.timebaseSpinBox.text()+'\n')
        f.write(self.segmentsSpinBox.text()+'\n')
        f.write(self.capturesSpinBox.text()+'\n')
        f.write(self.totalRuntimeSpinBox.text()+'\n')
        f.write(self.timeUnitsComboBox.currentText()+'\n')
        f.write(self.preTriggerSamplesSpinBox.text()+'\n')
        f.write(self.postTriggerSamplesSpinBox.text()+'\n')
        f.write(self.samplesPerBufferSpinBox.text()+'\n')
        f.write(self.triggerTypeComboBox.currentText()+'\n')
        f.write(self.aAutotriggerSpinBox.text()+'\n')
        f.write(self.aDelaySpinBox.text()+'\n')
        f.write(str(self.aTriggerCheck.checkState())+'\n')
        f.write(str(self.bTriggerCheck.checkState())+'\n')
        f.write(str(self.cTriggerCheck.checkState())+'\n')
        f.write(str(self.dTriggerCheck.checkState())+'\n')
        f.write(str(self.extTriggerCheck.checkState())+'\n')
        f.write(self.aUpperThresholdSpinBox.text()+'\n')
        f.write(self.bUpperThresholdSpinBox.text()+'\n')
        f.write(self.cUpperThresholdSpinBox.text()+'\n')
        f.write(self.dUpperThresholdSpinBox.text()+'\n')
        f.write(self.extUpperThresholdSpinBox.text()+'\n')
        f.write(self.aUpperHysteresisSpinBox.text()+'\n')
        f.write(self.bUpperHysteresisSpinBox.text()+'\n')
        f.write(self.cUpperHysteresisSpinBox.text()+'\n')
        f.write(self.dUpperHysteresisSpinBox.text()+'\n')
        f.write(self.extUpperHysteresisSpinBox.text()+'\n')
        f.write(self.aLowerThresholdSpinBox.text()+'\n')
        f.write(self.bLowerThresholdSpinBox.text()+'\n')
        f.write(self.cLowerThresholdSpinBox.text()+'\n')
        f.write(self.dLowerThresholdSpinBox.text()+'\n')
        f.write(self.extLowerThresholdSpinBox.text()+'\n')
        f.write(self.aLowerHysteresisSpinBox.text()+'\n')
        f.write(self.bLowerHysteresisSpinBox.text()+'\n')
        f.write(self.cLowerHysteresisSpinBox.text()+'\n')
        f.write(self.dLowerHysteresisSpinBox.text()+'\n')
        f.write(self.extLowerHysteresisSpinBox.text()+'\n')
        f.write(self.aDirectionComboBox.currentText()+'\n')
        f.write(self.bDirectionComboBox.currentText()+'\n')
        f.write(self.cDirectionComboBox.currentText()+'\n')
        f.write(self.dDirectionComboBox.currentText()+'\n')
        f.write(self.extDirectionComboBox.currentText()+'\n')
        f.write(self.aThresholdModeComboBox.currentText()+'\n')
        f.write(self.bThresholdModeComboBox.currentText()+'\n')
        f.write(self.cThresholdModeComboBox.currentText()+'\n')
        f.write(self.dThresholdModeComboBox.currentText()+'\n')
        f.write(self.extThresholdModeComboBox.currentText()+'\n')
        f.write(str(len(conditionList['aStateComboBox']))+'\n')
        for name in conditionList:
            if name in ['conditionTab', 'extConditionLabel', 'aConditionLabel', 'bConditionLabel', 'cConditionLabel', 'dConditionLabel', 'stateLabel']:
                continue
            for element in conditionList[name]:
                f.write(element.currentText()+'\n')
        f.close()
        self.presetComboBox.addItem(presetFileName)
        self.presetComboBox.setCurrentText(presetFileName)

    def loadPreset(self):
        presetFilePath = QtWidgets.QFileDialog.getOpenFileName(MainWindow, 'Find Preset File', '.')
        if presetFilePath[0] == '':
            return 0
        f = open(presetFilePath[0], 'r')
        driver = f.readline().replace('\n', '')
        if self.driverLineEdit.text() != driver:
            self.error = QtWidgets.QMessageBox()
            self.error.setWindowTitle('Error')
            icon = QtGui.QIcon()
            icon.addPixmap(QtGui.QPixmap(".\\icon.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
            self.error.setWindowIcon(icon)
            self.error.setText('Incompatible Driver Preset')
            self.error.setIcon(QtWidgets.QMessageBox.Information)
            ok = self.error.exec_()
            return 0
        self.outFileCheckBox.setCheckState(int(f.readline().replace('\n', '')))
        self.outFileNameLineEdit.setText(f.readline().replace('\n', ''))
        self.runsSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.aCheck.setCheckState(int(f.readline().replace('\n', '')))
        self.bCheck.setCheckState(int(f.readline().replace('\n', '')))
        self.cCheck.setCheckState(int(f.readline().replace('\n', '')))
        self.dCheck.setCheckState(int(f.readline().replace('\n', '')))
        self.aRangeComboBox.setCurrentText(f.readline().replace('\n', ''))
        self.bRangeComboBox.setCurrentText(f.readline().replace('\n', ''))
        self.cRangeComboBox.setCurrentText(f.readline().replace('\n', ''))
        self.dRangeComboBox.setCurrentText(f.readline().replace('\n', ''))
        self.aOffsetSpinBox.setValue(float(f.readline().replace('\n', '')))
        self.bOffsetSpinBox.setValue(float(f.readline().replace('\n', '')))
        self.cOffsetSpinBox.setValue(float(f.readline().replace('\n', '')))
        self.dOffsetSpinBox.setValue(float(f.readline().replace('\n', '')))
        self.modeComboBox.setCurrentText(f.readline().replace('\n', ''))
        self.timebaseSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.segmentsSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.capturesSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.totalRuntimeSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.timeUnitsComboBox.setCurrentText(f.readline().replace('\n', ''))
        self.preTriggerSamplesSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.postTriggerSamplesSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.samplesPerBufferSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.triggerTypeComboBox.setCurrentText(f.readline().replace('\n', ''))
        self.aAutotriggerSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.aDelaySpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.aTriggerCheck.setCheckState(int(f.readline().replace('\n', '')))
        self.bTriggerCheck.setCheckState(int(f.readline().replace('\n', '')))
        self.cTriggerCheck.setCheckState(int(f.readline().replace('\n', '')))
        self.dTriggerCheck.setCheckState(int(f.readline().replace('\n', '')))
        self.extTriggerCheck.setCheckState(int(f.readline().replace('\n', '')))
        self.aUpperThresholdSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.bUpperThresholdSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.cUpperThresholdSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.dUpperThresholdSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.extUpperThresholdSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.aUpperHysteresisSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.bUpperHysteresisSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.cUpperHysteresisSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.dUpperHysteresisSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.extUpperHysteresisSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.aLowerThresholdSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.bLowerThresholdSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.cLowerThresholdSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.dLowerThresholdSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.extLowerThresholdSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.aLowerHysteresisSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.bLowerHysteresisSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.cLowerHysteresisSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.dLowerHysteresisSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.extLowerHysteresisSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.aDirectionComboBox.setCurrentText(f.readline().replace('\n', ''))
        self.bDirectionComboBox.setCurrentText(f.readline().replace('\n', ''))
        self.cDirectionComboBox.setCurrentText(f.readline().replace('\n', ''))
        self.dDirectionComboBox.setCurrentText(f.readline().replace('\n', ''))
        self.extDirectionComboBox.setCurrentText(f.readline().replace('\n', ''))
        self.aThresholdModeComboBox.setCurrentText(f.readline().replace('\n', ''))
        self.bThresholdModeComboBox.setCurrentText(f.readline().replace('\n', ''))
        self.cThresholdModeComboBox.setCurrentText(f.readline().replace('\n', ''))
        self.dThresholdModeComboBox.setCurrentText(f.readline().replace('\n', ''))
        self.extThresholdModeComboBox.setCurrentText(f.readline().replace('\n', ''))
        for i in range(len(conditionList['aStateComboBox'])):
            self.deleteCondition()
        conditionNum = int(f.readline().replace('\n', ''))
        for i in range(conditionNum):
            self.newCondition()
        for name in conditionList:
            if name in ['conditionTab', 'extConditionLabel', 'aConditionLabel', 'bConditionLabel', 'cConditionLabel', 'dConditionLabel', 'stateLabel']:
                continue
            for i in range(conditionNum):
                conditionList[name][i].setCurrentText(f.readline().replace('\n', ''))
        f.close()
        self.presetComboBox.setCurrentText(str(os.path.basename(presetFilePath[0])).split('.')[0])

    def loadDetectedPreset(self):
        if self.presetComboBox.currentText() == 'Manual':
            return 0
        presetFilePath = ['./presets/'+str(self.presetComboBox.currentText())+'.prst']
        f = open(presetFilePath[0], 'r')
        self.driverLineEdit.setText(f.readline().replace('\n', ''))
        self.outFileCheckBox.setCheckState(int(f.readline().replace('\n', '')))
        self.outFileNameLineEdit.setText(f.readline().replace('\n', ''))
        self.runsSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.aCheck.setCheckState(int(f.readline().replace('\n', '')))
        self.bCheck.setCheckState(int(f.readline().replace('\n', '')))
        self.cCheck.setCheckState(int(f.readline().replace('\n', '')))
        self.dCheck.setCheckState(int(f.readline().replace('\n', '')))
        self.aRangeComboBox.setCurrentText(f.readline().replace('\n', ''))
        self.bRangeComboBox.setCurrentText(f.readline().replace('\n', ''))
        self.cRangeComboBox.setCurrentText(f.readline().replace('\n', ''))
        self.dRangeComboBox.setCurrentText(f.readline().replace('\n', ''))
        self.aOffsetSpinBox.setValue(float(f.readline().replace('\n', '')))
        self.bOffsetSpinBox.setValue(float(f.readline().replace('\n', '')))
        self.cOffsetSpinBox.setValue(float(f.readline().replace('\n', '')))
        self.dOffsetSpinBox.setValue(float(f.readline().replace('\n', '')))
        self.modeComboBox.setCurrentText(f.readline().replace('\n', ''))
        self.timebaseSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.segmentsSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.capturesSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.totalRuntimeSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.timeUnitsComboBox.setCurrentText(f.readline().replace('\n', ''))
        self.preTriggerSamplesSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.postTriggerSamplesSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.samplesPerBufferSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.triggerTypeComboBox.setCurrentText(f.readline().replace('\n', ''))
        self.aAutotriggerSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.aDelaySpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.aTriggerCheck.setCheckState(int(f.readline().replace('\n', '')))
        self.bTriggerCheck.setCheckState(int(f.readline().replace('\n', '')))
        self.cTriggerCheck.setCheckState(int(f.readline().replace('\n', '')))
        self.dTriggerCheck.setCheckState(int(f.readline().replace('\n', '')))
        self.extTriggerCheck.setCheckState(int(f.readline().replace('\n', '')))
        self.aUpperThresholdSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.bUpperThresholdSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.cUpperThresholdSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.dUpperThresholdSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.extUpperThresholdSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.aUpperHysteresisSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.bUpperHysteresisSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.cUpperHysteresisSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.dUpperHysteresisSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.extUpperHysteresisSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.aLowerThresholdSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.bLowerThresholdSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.cLowerThresholdSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.dLowerThresholdSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.extLowerThresholdSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.aLowerHysteresisSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.bLowerHysteresisSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.cLowerHysteresisSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.dLowerHysteresisSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.extLowerHysteresisSpinBox.setValue(int(float(f.readline().replace('\n', ''))))
        self.aDirectionComboBox.setCurrentText(f.readline().replace('\n', ''))
        self.bDirectionComboBox.setCurrentText(f.readline().replace('\n', ''))
        self.cDirectionComboBox.setCurrentText(f.readline().replace('\n', ''))
        self.dDirectionComboBox.setCurrentText(f.readline().replace('\n', ''))
        self.extDirectionComboBox.setCurrentText(f.readline().replace('\n', ''))
        self.aThresholdModeComboBox.setCurrentText(f.readline().replace('\n', ''))
        self.bThresholdModeComboBox.setCurrentText(f.readline().replace('\n', ''))
        self.cThresholdModeComboBox.setCurrentText(f.readline().replace('\n', ''))
        self.dThresholdModeComboBox.setCurrentText(f.readline().replace('\n', ''))
        self.extThresholdModeComboBox.setCurrentText(f.readline().replace('\n', ''))
        for i in range(len(conditionList['aStateComboBox'])):
            self.deleteCondition()
        conditionNum = int(f.readline().replace('\n', ''))
        for i in range(conditionNum):
            self.newCondition()
        for name in conditionList:
            if name in ['conditionTab', 'extConditionLabel', 'aConditionLabel', 'bConditionLabel', 'cConditionLabel', 'dConditionLabel', 'stateLabel']:
                continue
            for i in range(conditionNum):
                conditionList[name][i].setCurrentText(f.readline().replace('\n', ''))
        f.close()

    def autodetect(self):
        self.driverLineEdit.setText(driver_autodetect())

    def simpleTriggerCheck(self):
        if self.triggerTypeComboBox.currentText() == 'Simple':
            if bool(int(self.aTriggerCheck.checkState())):
                self.bTriggerCheck.setEnabled(False)
                self.cTriggerCheck.setEnabled(False)
                self.dTriggerCheck.setEnabled(False)
                self.extTriggerCheck.setEnabled(False)
                self.bUpperThresholdSpinBox.setEnabled(False)
                self.cUpperThresholdSpinBox.setEnabled(False)
                self.dUpperThresholdSpinBox.setEnabled(False)
                self.extUpperThresholdSpinBox.setEnabled(False)
                self.bDirectionComboBox.setEnabled(False)
                self.cDirectionComboBox.setEnabled(False)
                self.dDirectionComboBox.setEnabled(False)
                self.extDirectionComboBox.setEnabled(False)
            elif bool(int(self.bTriggerCheck.checkState())):
                self.aTriggerCheck.setEnabled(False)
                self.cTriggerCheck.setEnabled(False)
                self.dTriggerCheck.setEnabled(False)
                self.extTriggerCheck.setEnabled(False)
                self.aUpperThresholdSpinBox.setEnabled(False)
                self.cUpperThresholdSpinBox.setEnabled(False)
                self.dUpperThresholdSpinBox.setEnabled(False)
                self.extUpperThresholdSpinBox.setEnabled(False)
                self.aDirectionComboBox.setEnabled(False)
                self.cDirectionComboBox.setEnabled(False)
                self.dDirectionComboBox.setEnabled(False)
                self.extDirectionComboBox.setEnabled(False)
            elif bool(int(self.cTriggerCheck.checkState())):
                self.aTriggerCheck.setEnabled(False)
                self.bTriggerCheck.setEnabled(False)
                self.dTriggerCheck.setEnabled(False)
                self.extTriggerCheck.setEnabled(False)
                self.aUpperThresholdSpinBox.setEnabled(False)
                self.bUpperThresholdSpinBox.setEnabled(False)
                self.dUpperThresholdSpinBox.setEnabled(False)
                self.extUpperThresholdSpinBox.setEnabled(False)
                self.aDirectionComboBox.setEnabled(False)
                self.bDirectionComboBox.setEnabled(False)
                self.dDirectionComboBox.setEnabled(False)
                self.extDirectionComboBox.setEnabled(False)
            elif bool(int(self.dTriggerCheck.checkState())):
                self.aTriggerCheck.setEnabled(False)
                self.bTriggerCheck.setEnabled(False)
                self.cTriggerCheck.setEnabled(False)
                self.extTriggerCheck.setEnabled(False)
                self.aUpperThresholdSpinBox.setEnabled(False)
                self.bUpperThresholdSpinBox.setEnabled(False)
                self.cUpperThresholdSpinBox.setEnabled(False)
                self.extUpperThresholdSpinBox.setEnabled(False)
                self.aDirectionComboBox.setEnabled(False)
                self.bDirectionComboBox.setEnabled(False)
                self.cDirectionComboBox.setEnabled(False)
                self.extDirectionComboBox.setEnabled(False)
            elif bool(int(self.extTriggerCheck.checkState())):
                self.aTriggerCheck.setEnabled(False)
                self.bTriggerCheck.setEnabled(False)
                self.cTriggerCheck.setEnabled(False)
                self.dTriggerCheck.setEnabled(False)
                self.aUpperThresholdSpinBox.setEnabled(False)
                self.bUpperThresholdSpinBox.setEnabled(False)
                self.cUpperThresholdSpinBox.setEnabled(False)
                self.dUpperThresholdSpinBox.setEnabled(False)
                self.aDirectionComboBox.setEnabled(False)
                self.bDirectionComboBox.setEnabled(False)
                self.cDirectionComboBox.setEnabled(False)
                self.dDirectionComboBox.setEnabled(False)
            else:
                if self.driverLineEdit.text() == 'ps2000a':
                    self.aTriggerCheck.setEnabled(True)
                    self.bTriggerCheck.setEnabled(True)
                    self.aUpperThresholdSpinBox.setEnabled(True)
                    self.bUpperThresholdSpinBox.setEnabled(True)
                    self.aDirectionComboBox.setEnabled(True)
                    self.bDirectionComboBox.setEnabled(True)
                else:
                    self.aTriggerCheck.setEnabled(True)
                    self.bTriggerCheck.setEnabled(True)
                    self.cTriggerCheck.setEnabled(True)
                    self.dTriggerCheck.setEnabled(True)
                    self.extTriggerCheck.setEnabled(True)
                    self.aUpperThresholdSpinBox.setEnabled(True)
                    self.bUpperThresholdSpinBox.setEnabled(True)
                    self.cUpperThresholdSpinBox.setEnabled(True)
                    self.dUpperThresholdSpinBox.setEnabled(True)
                    self.extUpperThresholdSpinBox.setEnabled(True)
                    self.aDirectionComboBox.setEnabled(True)
                    self.bDirectionComboBox.setEnabled(True)
                    self.cDirectionComboBox.setEnabled(True)
                    self.dDirectionComboBox.setEnabled(True)
                    self.extDirectionComboBox.setEnabled(True)

    def run(self):
        _translate = QtCore.QCoreApplication.translate
        global runList
        #Reset
        self.tabWidget.clear()
        runList = {'runTab': [], 'stackedWidget': [], 'captureTab': []}
        chandle = ctypes.c_int16()
        status = {}
        start_scope([chandle, status])
        #Channel Configuration
        channels_ = []
        couplings_ = []
        cranges_ = []
        offsets_ = []
        if bool(int(self.aCheck.checkState())):
            channels_.append(0)
            couplings_.append(self.aCouplingComboBox.currentIndex())
            cranges_.append(self.aRangeComboBox.currentIndex())
            offsets_.append(float(self.aOffsetSpinBox.text()))
        if bool(int(self.bCheck.checkState())):
            channels_.append(1)
            couplings_.append(self.bCouplingComboBox.currentIndex())
            cranges_.append(self.bRangeComboBox.currentIndex())
            offsets_.append(float(self.bOffsetSpinBox.text()))
        if bool(int(self.cCheck.checkState())):
            channels_.append(2)
            couplings_.append(self.cCouplingComboBox.currentIndex())
            cranges_.append(self.cRangeComboBox.currentIndex())
            offsets_.append(float(self.cOffsetSpinBox.text()))
        if bool(int(self.dCheck.checkState())):
            channels_.append(3)
            couplings_.append(self.dCouplingComboBox.currentIndex())
            cranges_.append(self.dRangeComboBox.currentIndex())
            offsets_.append(float(self.dOffsetSpinBox.text()))
        channel_config(chandle, status, 1, channels_, couplings_, cranges_, offsets_)

        #Trigger Configuration
        trigChannel = 0 #Default Value
        trigAdcCounts = 0
        trigDirection = 0
        if self.triggerTypeComboBox.currentText() == 'Simple':
            if bool(int(self.aTriggerCheck.checkState())):
                trigChannel = 0
                trigAdcCounts = int(self.aUpperThresholdSpinBox.text())
                trigDirection = int(self.aDirectionComboBox.currentIndex())
            elif bool(int(self.bTriggerCheck.checkState())):
                trigChannel = 1
                trigAdcCounts = int(self.bUpperThresholdSpinBox.text())
                trigDirection = int(self.bDirectionComboBox.currentIndex())
            elif bool(int(self.cTriggerCheck.checkState())):
                trigChannel = 2
                trigAdcCounts = int(self.cUpperThresholdSpinBox.text())
                trigDirection = int(self.cDirectionComboBox.currentIndex())
            elif bool(int(self.dTriggerCheck.checkState())):
                trigChannel = 3
                trigAdcCounts = int(self.dUpperThresholdSpinBox.text())
                trigDirection = int(self.dDirectionComboBox.currentIndex())
            elif bool(int(self.extTriggerCheck.checkState())):
                trigChannel = 4
                trigAdcCounts = int(self.extUpperThresholdSpinBox.text())
                trigDirection = int(self.extDirectionComboBox.currentIndex())
            trig_simple_config(chandle, status, 1, trigChannel, trigAdcCounts, trigDirection, int(self.aDelaySpinBox.text()), int(self.aAutotriggerSpinBox.text())) #Setup a simple trigger
        elif self.triggerTypeComboBox.currentText() == 'Complex':
            trigCond_ = []
            for i in range(len(conditionList['conditionTab'])):
                trigCond_.append([conditionList['aStateComboBox'][i].currentIndex(), conditionList['bStateComboBox'][i].currentIndex(), conditionList['cStateComboBox'][i].currentIndex(), conditionList['dStateComboBox'][i].currentIndex(), conditionList['extStateComboBox'][i].currentIndex(), 0, 0, 0])
            trigChannelConf_ = []
            if bool(int(self.aTriggerCheck.checkState())):
                trigChannelConf_.append([int(self.aUpperThresholdSpinBox.text()), int(self.aUpperHysteresisSpinBox.text()), int(self.aLowerThresholdSpinBox.text()), int(self.aLowerHysteresisSpinBox.text()), 0 ,int(self.aThresholdModeComboBox.currentIndex())])
            if bool(int(self.bTriggerCheck.checkState())):
                trigChannelConf_.append([int(self.bUpperThresholdSpinBox.text()), int(self.bUpperHysteresisSpinBox.text()), int(self.bLowerThresholdSpinBox.text()), int(self.bLowerHysteresisSpinBox.text()), 1 ,int(self.bThresholdModeComboBox.currentIndex())])
            if bool(int(self.cTriggerCheck.checkState())):
                trigChannelConf_.append([int(self.cUpperThresholdSpinBox.text()), int(self.cUpperHysteresisSpinBox.text()), int(self.cLowerThresholdSpinBox.text()), int(self.cLowerHysteresisSpinBox.text()), 2 ,int(self.cThresholdModeComboBox.currentIndex())])
            if bool(int(self.dTriggerCheck.checkState())):
                trigChannelConf_.append([int(self.dUpperThresholdSpinBox.text()), int(self.dUpperHysteresisSpinBox.text()), int(self.dLowerThresholdSpinBox.text()), int(self.dLowerHysteresisSpinBox.text()), 3 ,int(self.dThresholdModeComboBox.currentIndex())])
            if bool(int(self.extTriggerCheck.checkState())):
                trigChannelConf_.append([int(self.extUpperThresholdSpinBox.text()), int(self.extUpperHysteresisSpinBox.text()), int(self.extLowerThresholdSpinBox.text()), int(self.extLowerHysteresisSpinBox.text()), 4 ,int(self.extThresholdModeComboBox.currentIndex())])
            print(chandle, status, trigCond_, [self.aDirectionComboBox.currentIndex(), self.bDirectionComboBox.currentIndex(), self.cDirectionComboBox.currentIndex(), self.dDirectionComboBox.currentIndex(), self.extDirectionComboBox.currentIndex(), self.aDirectionComboBox.currentIndex()], trigChannelConf_, int(self.aAutotriggerSpinBox.text()))
            trig_logic_config(chandle, status, trigCond_, [self.aDirectionComboBox.currentIndex(), self.bDirectionComboBox.currentIndex(), self.cDirectionComboBox.currentIndex(), self.dDirectionComboBox.currentIndex(), self.extDirectionComboBox.currentIndex(), self.aDirectionComboBox.currentIndex()], trigChannelConf_, int(self.aAutotriggerSpinBox.text()))

        #Capture Configuration
        buffFileName = 'buffer_swap.txt'
        buff = open(buffFileName, 'w')
        buff.close()
        if self.modeComboBox.currentText() == 'Block':
            preTriggerSamples = int(self.preTriggerSamplesSpinBox.text())
            postTriggerSamples = int(self.postTriggerSamplesSpinBox.text())
            timebase = int(self.timebaseSpinBox.text())
            totalSamples = preTriggerSamples+postTriggerSamples
            segments = int(self.segmentsSpinBox.text())
            captures = int(self.capturesSpinBox.text())
            time_ = timebase_block_config(chandle, status, timebase, totalSamples) #Setup timebase and time axis
            buffersMax, buffersMin = buffer_block_config(chandle, status, channels_, totalSamples, segments, 0) #Setup buffer and segments
            buff = open(buffFileName, 'a')
            if bool(int(self.outFileCheckBox.checkState())):
                clear_file(self.outFileNameLineEdit.text())
            for i in range(int(self.runsSpinBox.text())):
                data_block(chandle, status, preTriggerSamples, postTriggerSamples, timebase, 0, 0) #Get data
                for chann in buffersMax:
                    for segm in chann:
                        for j in segm:
                            buff.write(str(j)+',')
                        buff.write('\n\n')
                    buff.write('/\n')
                buff.write('//\n')
        elif self.modeComboBox.currentText() == 'Rapid Block':
            preTriggerSamples = int(self.preTriggerSamplesSpinBox.text())
            postTriggerSamples = int(self.postTriggerSamplesSpinBox.text())
            timebase = int(self.timebaseSpinBox.text())
            totalSamples = preTriggerSamples+postTriggerSamples
            segments = int(self.segmentsSpinBox.text())
            captures = int(self.capturesSpinBox.text())
            time_ = timebase_block_config(chandle, status, timebase, totalSamples) #Setup timebase and time axis
            segment_capture_config(chandle, status, segments, captures, totalSamples) #Setup memory segmentation & capture configuration
            buffersMax, buffersMin = buffer_block_config(chandle, status, channels_, totalSamples, segments, 0) #Setup buffer and segments
            buff = open(buffFileName, 'a')
            if bool(int(self.outFileCheckBox.checkState())):
                clear_file(self.outFileNameLineEdit.text())
            for i in range(int(self.runsSpinBox.text())):
                data_rapid_block(chandle, status, preTriggerSamples, postTriggerSamples, timebase, segments, captures, 0, 0) #Get data
                for chann in buffersMax:
                    for segm in chann:
                        for j in segm:
                            buff.write(str(j)+',')
                        buff.write('\n\n')
                    buff.write('/\n')
                buff.write('//\n')
        elif self.modeComboBox.currentText() == 'Streaming':
            preTriggerSamples = int(self.preTriggerSamplesSpinBox.text())
            postTriggerSamples = int(self.postTriggerSamplesSpinBox.text())
            totalSamples = preTriggerSamples+postTriggerSamples
            sizeOfOneBuffer = int(self.samplesPerBufferSpinBox.text())
            totalRuntime = int(self.totalRuntimeSpinBox.text())
            sampleInterval = int(totalRuntime/totalSamples)
            sampleUnits = int(self.timeUnitsComboBox.currentIndex())
            segments = int(self.segmentsSpinBox.text())
            captures = int(self.capturesSpinBox.text())
            time_ = timebase_stream_config(totalSamples, sampleInterval, sampleUnits) #Setup timebase and time axis
            buffersComplete, buffersMax, buffersMin = buffer_stream_config(chandle, status, channels_, totalSamples, sizeOfOneBuffer, segments, 0) #Setup buffers
            buff = open(buffFileName, 'a')
            if bool(int(self.outFileCheckBox.checkState())):
                clear_file(self.outFileNameLineEdit.text())
            for i in range(int(self.runsSpinBox.text())):
                data_streaming(chandle, status, sampleInterval, 0, buffersComplete, buffersMax, sizeOfOneBuffer, sampleUnits, preTriggerSamples, postTriggerSamples, 0, 1) #Get data
                for chann in buffersMax:
                    for segm in chann:
                        for j in segm:
                            buff.write(str(j)+',')
                        buff.write('\n\n')
                    buff.write('/\n')
                buff.write('//\n')
        buff.write('F') #EOF character
        buff.close()

        #Data Processing
        tabMax = 7
        capturesMax = 7
        indx = 0
        buff = open(buffFileName, 'r')
        temp = buff.readline().replace('\n', '')
        while temp != 'F':
            indx += 1
            run = []
            while temp != '//':
                chann = []
                while temp != '/':
                    segm = []
                    while temp != '':
                        data = ''
                        for char in temp:
                            if char == ',':
                                segm.append(int(data))
                                data = ''
                            else:
                                data += char
                        temp = buff.readline().replace('\n', '')
                    chann.append(segm)
                    temp = buff.readline().replace('\n', '')
                run.append(chann)
                temp = buff.readline().replace('\n', '')
            #print(run)
            run = run_to_mV(chandle, status, run, channels_, cranges_, totalSamples, segments)
            if bool(int(self.graphCheck.checkState())) and len(runList['runTab']) < tabMax:
                runList['runTab'].append(QtWidgets.QWidget())
                runList['runTab'][-1].setObjectName("run_"+str(indx))
                runList['stackedWidget'].append(QtWidgets.QStackedWidget(runList['runTab'][-1]))
                runList['stackedWidget'][-1].setGeometry(QtCore.QRect(0*widthRatio, 0*heightRatio, 461*widthRatio, 361*heightRatio))
                runList['stackedWidget'][-1].setObjectName("stackedWidget_"+str(indx))
                runList['captureTab'].append([])
                self.tabWidget.addTab(runList['runTab'][-1], "")
                self.tabWidget.setTabText(self.tabWidget.indexOf(runList['runTab'][-1]), _translate("MainWindow", "Run "+str(indx)))
                for i in range(captures):
                    if i >= capturesMax:
                        break
                    runList['captureTab'][-1].append(Canvas(self, width=4.61*widthRatio, height=3.61*heightRatio, dpi=100))
                    for j in range(len(channels_)):
                        run_channel_capture = run[j][i]
                        runList['captureTab'][-1][-1].axes.plot(time_, run_channel_capture)
                        runList['captureTab'][-1][-1].axes.set(xlabel = 'Time ('+self.timeUnitsComboBox.currentText()+')', ylabel = 'Voltage (mV)', title = 'Capture '+str(i+1))
                    runList['stackedWidget'][-1].addWidget(runList['captureTab'][-1][i])
                self.pageChangeCheck()
            else:
                plt.close('all')
            if bool(int(self.outFileCheckBox.checkState())): #True for file writing
                run_to_file(time_, self.timeUnitsComboBox.currentText(), run, channels_, segments, indx, self.outFileNameLineEdit.text())
            temp = buff.readline().replace('\n', '')
        stop_scope([chandle, status])

if __name__ == "__main__":
    import sys
    app = QtWidgets.QApplication(sys.argv)
    MainWindow = QtWidgets.QMainWindow()
    ui = Ui_MainWindow()
    ui.setupUi(MainWindow)
    MainWindow.show()
    sys.exit(app.exec_())
